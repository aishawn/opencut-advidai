{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/lib/mediabunny-utils.ts"],"sourcesContent":["import { FFmpeg } from \"@ffmpeg/ffmpeg\";\nimport { useTimelineStore } from \"@/stores/timeline-store\";\nimport { useMediaStore } from \"@/stores/media-store\";\nimport { Input, ALL_FORMATS, BlobSource, VideoSampleSink } from \"mediabunny\";\n\nlet ffmpeg: FFmpeg | null = null;\n\nexport const initFFmpeg = async (): Promise<FFmpeg> => {\n  if (ffmpeg) return ffmpeg;\n\n  ffmpeg = new FFmpeg();\n  await ffmpeg.load(); // Use default config\n\n  return ffmpeg;\n};\n\nexport async function generateThumbnail({\n  videoFile,\n  timeInSeconds,\n}: {\n  videoFile: File;\n  timeInSeconds: number;\n}): Promise<string> {\n  const input = new Input({\n    source: new BlobSource(videoFile),\n    formats: ALL_FORMATS,\n  });\n\n  const videoTrack = await input.getPrimaryVideoTrack();\n  if (!videoTrack) {\n    throw new Error(\"No video track found in the file\");\n  }\n\n  // Check if we can decode this video\n  const canDecode = await videoTrack.canDecode();\n  if (!canDecode) {\n    throw new Error(\"Video codec not supported for decoding\");\n  }\n\n  const sink = new VideoSampleSink(videoTrack);\n\n  const frame = await sink.getSample(timeInSeconds);\n\n  if (!frame) {\n    throw new Error(\"Could not get frame at specified time\");\n  }\n\n  const canvas = document.createElement(\"canvas\");\n  canvas.width = 320;\n  canvas.height = 240;\n  const ctx = canvas.getContext(\"2d\");\n\n  if (!ctx) {\n    throw new Error(\"Could not get canvas context\");\n  }\n\n  frame.draw(ctx, 0, 0, 320, 240);\n\n  return new Promise((resolve, reject) => {\n    canvas.toBlob(\n      (blob) => {\n        if (blob) {\n          resolve(URL.createObjectURL(blob));\n        } else {\n          reject(new Error(\"Failed to create thumbnail blob\"));\n        }\n      },\n      \"image/jpeg\",\n      0.8\n    );\n  });\n}\n\nexport async function getVideoInfo({\n  videoFile,\n}: {\n  videoFile: File;\n}): Promise<{\n  duration: number;\n  width: number;\n  height: number;\n  fps: number;\n}> {\n  const input = new Input({\n    source: new BlobSource(videoFile),\n    formats: ALL_FORMATS,\n  });\n\n  const duration = await input.computeDuration();\n  const videoTrack = await input.getPrimaryVideoTrack();\n\n  if (!videoTrack) {\n    throw new Error(\"No video track found in the file\");\n  }\n\n  // Get frame rate from packet statistics\n  const packetStats = await videoTrack.computePacketStats(100);\n  const fps = packetStats.averagePacketRate;\n\n  return {\n    duration,\n    width: videoTrack.displayWidth,\n    height: videoTrack.displayHeight,\n    fps,\n  };\n}\n\n// Audio mixing for timeline - keeping FFmpeg for now due to complexity\n// TODO: Replace with Mediabunny audio processing when implementing canvas preview\nexport const extractTimelineAudio = async (\n  onProgress?: (progress: number) => void\n): Promise<Blob> => {\n  // Create fresh FFmpeg instance for this operation\n  const ffmpeg = new FFmpeg();\n\n  try {\n    await ffmpeg.load();\n  } catch (error) {\n    console.error(\"Failed to load fresh FFmpeg instance:\", error);\n    throw new Error(\"Unable to initialize audio processing. Please try again.\");\n  }\n\n  const timeline = useTimelineStore.getState();\n  const mediaStore = useMediaStore.getState();\n\n  const tracks = timeline.tracks;\n  const totalDuration = timeline.getTotalDuration();\n\n  if (totalDuration === 0) {\n    const emptyAudioData = new ArrayBuffer(44);\n    return new Blob([emptyAudioData], { type: \"audio/wav\" });\n  }\n\n  if (onProgress) {\n    ffmpeg.on(\"progress\", ({ progress }) => {\n      onProgress(progress * 100);\n    });\n  }\n\n  const audioElements: Array<{\n    file: File;\n    startTime: number;\n    duration: number;\n    trimStart: number;\n    trimEnd: number;\n    trackMuted: boolean;\n  }> = [];\n\n  for (const track of tracks) {\n    if (track.muted) continue;\n\n    for (const element of track.elements) {\n      if (element.type === \"media\") {\n        const mediaFile = mediaStore.mediaFiles.find(\n          (m) => m.id === element.mediaId\n        );\n        if (!mediaFile) continue;\n\n        if (mediaFile.type === \"video\" || mediaFile.type === \"audio\") {\n          audioElements.push({\n            file: mediaFile.file,\n            startTime: element.startTime,\n            duration: element.duration,\n            trimStart: element.trimStart,\n            trimEnd: element.trimEnd,\n            trackMuted: track.muted || false,\n          });\n        }\n      }\n    }\n  }\n\n  if (audioElements.length === 0) {\n    // Return silent audio if no audio elements\n    const silentDuration = Math.max(1, totalDuration); // At least 1 second\n    try {\n      const silentAudio = await generateSilentAudio(silentDuration);\n      return silentAudio;\n    } catch (error) {\n      console.error(\"Failed to generate silent audio:\", error);\n      throw new Error(\"Unable to generate audio for empty timeline.\");\n    }\n  }\n\n  // Create a complex filter to mix all audio sources\n  const inputFiles: string[] = [];\n  const filterInputs: string[] = [];\n\n  try {\n    for (let i = 0; i < audioElements.length; i++) {\n      const element = audioElements[i];\n      const inputName = `input_${i}.${element.file.name.split(\".\").pop()}`;\n      inputFiles.push(inputName);\n\n      try {\n        await ffmpeg.writeFile(\n          inputName,\n          new Uint8Array(await element.file.arrayBuffer())\n        );\n      } catch (error) {\n        console.error(`Failed to write file ${element.file.name}:`, error);\n        throw new Error(\n          `Unable to process file: ${element.file.name}. The file may be corrupted or in an unsupported format.`\n        );\n      }\n\n      const actualStart = element.trimStart;\n      const actualDuration =\n        element.duration - element.trimStart - element.trimEnd;\n\n      const filterName = `audio_${i}`;\n      filterInputs.push(\n        `[${i}:a]atrim=start=${actualStart}:duration=${actualDuration},asetpts=PTS-STARTPTS,adelay=${element.startTime * 1000}|${element.startTime * 1000}[${filterName}]`\n      );\n    }\n\n    const mixFilter =\n      audioElements.length === 1\n        ? `[audio_0]aresample=44100,aformat=sample_fmts=s16:channel_layouts=stereo[out]`\n        : `${filterInputs.map((_, i) => `[audio_${i}]`).join(\"\")}amix=inputs=${audioElements.length}:duration=longest:dropout_transition=2,aresample=44100,aformat=sample_fmts=s16:channel_layouts=stereo[out]`;\n\n    const complexFilter = [...filterInputs, mixFilter].join(\";\");\n    const outputName = \"timeline_audio.wav\";\n\n    const ffmpegArgs = [\n      ...inputFiles.flatMap((name) => [\"-i\", name]),\n      \"-filter_complex\",\n      complexFilter,\n      \"-map\",\n      \"[out]\",\n      \"-t\",\n      totalDuration.toString(),\n      \"-c:a\",\n      \"pcm_s16le\",\n      \"-ar\",\n      \"44100\",\n      outputName,\n    ];\n\n    try {\n      await ffmpeg.exec(ffmpegArgs);\n    } catch (error) {\n      console.error(\"FFmpeg execution failed:\", error);\n      throw new Error(\n        \"Audio processing failed. Some audio files may be corrupted or incompatible.\"\n      );\n    }\n\n    const data = await ffmpeg.readFile(outputName);\n    const blob = new Blob([data], { type: \"audio/wav\" });\n\n    return blob;\n  } catch (error) {\n    for (const inputFile of inputFiles) {\n      try {\n        await ffmpeg.deleteFile(inputFile);\n      } catch (cleanupError) {\n        console.warn(`Failed to cleanup file ${inputFile}:`, cleanupError);\n      }\n    }\n    try {\n      await ffmpeg.deleteFile(\"timeline_audio.wav\");\n    } catch (cleanupError) {\n      console.warn(\"Failed to cleanup output file:\", cleanupError);\n    }\n\n    throw error;\n  } finally {\n    for (const inputFile of inputFiles) {\n      try {\n        await ffmpeg.deleteFile(inputFile);\n      } catch (cleanupError) {}\n    }\n    try {\n      await ffmpeg.deleteFile(\"timeline_audio.wav\");\n    } catch (cleanupError) {}\n  }\n};\n\nconst generateSilentAudio = async (durationSeconds: number): Promise<Blob> => {\n  const ffmpeg = await initFFmpeg();\n  const outputName = \"silent.wav\";\n\n  try {\n    await ffmpeg.exec([\n      \"-f\",\n      \"lavfi\",\n      \"-i\",\n      `anullsrc=channel_layout=stereo:sample_rate=44100`,\n      \"-t\",\n      durationSeconds.toString(),\n      \"-c:a\",\n      \"pcm_s16le\",\n      outputName,\n    ]);\n\n    const data = await ffmpeg.readFile(outputName);\n    const blob = new Blob([data], { type: \"audio/wav\" });\n\n    return blob;\n  } catch (error) {\n    console.error(\"Failed to generate silent audio:\", error);\n    throw error;\n  } finally {\n    try {\n      await ffmpeg.deleteFile(outputName);\n    } catch (cleanupError) {\n      // Silent cleanup\n    }\n  }\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 271, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/lib/media-processing.ts"],"sourcesContent":["import { toast } from \"sonner\";\nimport {\n  getFileType,\n  getMediaDuration,\n  getImageDimensions,\n} from \"@/stores/media-store\";\nimport { MediaFile } from \"@/types/media\";\nimport { generateThumbnail, getVideoInfo } from \"./mediabunny-utils\";\n\nexport interface ProcessedMediaItem extends Omit<MediaFile, \"id\"> {}\n\nexport async function processMediaFiles(\n  files: FileList | File[],\n  onProgress?: (progress: number) => void\n): Promise<ProcessedMediaItem[]> {\n  const fileArray = Array.from(files);\n  const processedItems: ProcessedMediaItem[] = [];\n\n  const total = fileArray.length;\n  let completed = 0;\n\n  for (const file of fileArray) {\n    const fileType = getFileType(file);\n\n    if (!fileType) {\n      toast.error(`Unsupported file type: ${file.name}`);\n      continue;\n    }\n\n    const url = URL.createObjectURL(file);\n    let thumbnailUrl: string | undefined;\n    let duration: number | undefined;\n    let width: number | undefined;\n    let height: number | undefined;\n    let fps: number | undefined;\n\n    try {\n      if (fileType === \"image\") {\n        const dimensions = await getImageDimensions(file);\n        width = dimensions.width;\n        height = dimensions.height;\n      } else if (fileType === \"video\") {\n        try {\n          const videoInfo = await getVideoInfo({ videoFile: file });\n          duration = videoInfo.duration;\n          width = videoInfo.width;\n          height = videoInfo.height;\n          fps = videoInfo.fps;\n\n          thumbnailUrl = await generateThumbnail({\n            videoFile: file,\n            timeInSeconds: 1,\n          });\n        } catch (error) {\n          console.warn(\"Video processing failed\", error);\n        }\n      } else if (fileType === \"audio\") {\n        // For audio, we don't set width/height/fps (they'll be undefined)\n        duration = await getMediaDuration(file);\n      }\n\n      processedItems.push({\n        name: file.name,\n        type: fileType,\n        file,\n        url,\n        thumbnailUrl,\n        duration,\n        width,\n        height,\n        fps,\n      });\n\n      await new Promise((resolve) => setTimeout(resolve, 0));\n\n      completed += 1;\n      if (onProgress) {\n        const percent = Math.round((completed / total) * 100);\n        onProgress(percent);\n      }\n    } catch (error) {\n      console.error(\"Error processing file:\", file.name, error);\n      toast.error(`Failed to process ${file.name}`);\n      URL.revokeObjectURL(url); // Clean up on error\n    }\n  }\n\n  return processedItems;\n}\n"],"names":[],"mappings":";;;AAAA;AACA;AAMA;;;;AAIO,eAAe,kBACpB,KAAwB,EACxB,UAAuC;IAEvC,MAAM,YAAY,MAAM,IAAI,CAAC;IAC7B,MAAM,iBAAuC,EAAE;IAE/C,MAAM,QAAQ,UAAU,MAAM;IAC9B,IAAI,YAAY;IAEhB,KAAK,MAAM,QAAQ,UAAW;QAC5B,MAAM,WAAW,CAAA,GAAA,iJAAA,CAAA,cAAW,AAAD,EAAE;QAE7B,IAAI,CAAC,UAAU;YACb,iNAAA,CAAA,QAAK,CAAC,KAAK,CAAC,AAAC,0BAAmC,OAAV,KAAK,IAAI;YAC/C;QACF;QAEA,MAAM,MAAM,IAAI,eAAe,CAAC;QAChC,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QAEJ,IAAI;YACF,IAAI,aAAa,SAAS;gBACxB,MAAM,aAAa,MAAM,CAAA,GAAA,iJAAA,CAAA,qBAAkB,AAAD,EAAE;gBAC5C,QAAQ,WAAW,KAAK;gBACxB,SAAS,WAAW,MAAM;YAC5B,OAAO,IAAI,aAAa,SAAS;gBAC/B,IAAI;oBACF,MAAM,YAAY,MAAM,CAAA,GAAA,mJAAA,CAAA,eAAY,AAAD,EAAE;wBAAE,WAAW;oBAAK;oBACvD,WAAW,UAAU,QAAQ;oBAC7B,QAAQ,UAAU,KAAK;oBACvB,SAAS,UAAU,MAAM;oBACzB,MAAM,UAAU,GAAG;oBAEnB,eAAe,MAAM,CAAA,GAAA,mJAAA,CAAA,oBAAiB,AAAD,EAAE;wBACrC,WAAW;wBACX,eAAe;oBACjB;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,IAAI,CAAC,2BAA2B;gBAC1C;YACF,OAAO,IAAI,aAAa,SAAS;gBAC/B,kEAAkE;gBAClE,WAAW,MAAM,CAAA,GAAA,iJAAA,CAAA,mBAAgB,AAAD,EAAE;YACpC;YAEA,eAAe,IAAI,CAAC;gBAClB,MAAM,KAAK,IAAI;gBACf,MAAM;gBACN;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;YACF;YAEA,MAAM,IAAI,QAAQ,CAAC,UAAY,WAAW,SAAS;YAEnD,aAAa;YACb,IAAI,YAAY;gBACd,MAAM,UAAU,KAAK,KAAK,CAAC,AAAC,YAAY,QAAS;gBACjD,WAAW;YACb;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B,KAAK,IAAI,EAAE;YACnD,iNAAA,CAAA,QAAK,CAAC,KAAK,CAAC,AAAC,qBAA8B,OAAV,KAAK,IAAI;YAC1C,IAAI,eAAe,CAAC,MAAM,oBAAoB;QAChD;IACF;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 356, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/lib/iconify-api.ts"],"sourcesContent":["\nexport const ICONIFY_HOSTS = [\n  \"https://api.iconify.design\",\n  \"https://api.simplesvg.com\",\n  \"https://api.unisvg.com\",\n];\n\nlet currentHost = ICONIFY_HOSTS[0];\n\nasync function fetchWithFallback(path: string): Promise<Response> {\n  for (const host of ICONIFY_HOSTS) {\n    try {\n      const response = await fetch(`${host}${path}`, {\n        signal: AbortSignal.timeout(2000),\n      });\n      if (response.ok) {\n        currentHost = host;\n        return response;\n      }\n    } catch (error) {\n      console.warn(`Failed to fetch from ${host}:`, error);\n    }\n  }\n  throw new Error(\"All API hosts failed\");\n}\n\nexport interface IconSet {\n  prefix: string;\n  name: string;\n  total: number;\n  author?: {\n    name: string;\n    url?: string;\n  };\n  license?: {\n    title: string;\n    spdx?: string;\n    url?: string;\n  };\n  samples?: string[];\n  category?: string;\n  palette?: boolean;\n}\n\nexport interface IconSearchResult {\n  icons: string[];\n  total: number;\n  limit: number;\n  start: number;\n  collections: Record<string, IconSet>;\n}\n\nexport interface CollectionInfo {\n  prefix: string;\n  total: number;\n  title?: string;\n  uncategorized?: string[];\n  categories?: Record<string, string[]>;\n  hidden?: string[];\n  aliases?: Record<string, string>;\n}\n\nexport async function getCollections(\n  category?: string\n): Promise<Record<string, IconSet>> {\n  try {\n    const response = await fetchWithFallback(\"/collections?pretty=1\");\n    const data = (await response.json()) as Record<string, IconSet>;\n\n    if (category) {\n      const filtered = Object.fromEntries(\n        Object.entries(data).filter(\n          ([_key, info]) => info.category === category\n        )\n      ) as Record<string, IconSet>;\n      return filtered;\n    }\n\n    return data;\n  } catch (error) {\n    console.error(\"Failed to fetch collections:\", error);\n    return {};\n  }\n}\n\nexport async function getCollection(\n  prefix: string\n): Promise<CollectionInfo | null> {\n  try {\n    const response = await fetchWithFallback(\n      `/collection?prefix=${prefix}&pretty=1`\n    );\n    return await response.json();\n  } catch (error) {\n    console.error(`Failed to fetch collection ${prefix}:`, error);\n    return null;\n  }\n}\n\nexport async function searchIcons(\n  query: string,\n  limit: number = 64,\n  prefixes?: string[],\n  category?: string\n): Promise<IconSearchResult> {\n  const params = new URLSearchParams({\n    query,\n    limit: limit.toString(),\n    pretty: \"1\",\n  });\n\n  if (prefixes?.length) {\n    params.append(\"prefixes\", prefixes.join(\",\"));\n  }\n\n  if (category) {\n    params.append(\"category\", category);\n  }\n\n  try {\n    const response = await fetchWithFallback(`/search?${params}`);\n    return await response.json();\n  } catch (error) {\n    console.error(\"Failed to search icons:\", error);\n    return {\n      icons: [],\n      total: 0,\n      limit,\n      start: 0,\n      collections: {},\n    };\n  }\n}\n\nexport function buildIconSvgUrl(\n  host: string,\n  iconName: string,\n  params?: {\n    color?: string;\n    width?: number;\n    height?: number;\n    flip?: \"horizontal\" | \"vertical\" | \"horizontal,vertical\";\n    rotate?: number | string;\n  }\n): string {\n  const [prefix, name] = iconName.includes(\":\")\n    ? iconName.split(\":\")\n    : [\"\", iconName];\n\n  if (!prefix || !name) {\n    throw new Error('Invalid icon name format. Expected \"prefix:name\"');\n  }\n\n  const urlParams = new URLSearchParams();\n\n  if (params?.color) {\n    urlParams.append(\"color\", params.color.replace(\"#\", \"%23\"));\n  }\n\n  if (params?.width) {\n    urlParams.append(\"width\", params.width.toString());\n  }\n\n  if (params?.height) {\n    urlParams.append(\"height\", params.height.toString());\n  }\n\n  if (params?.flip) {\n    urlParams.append(\"flip\", params.flip);\n  }\n\n  if (params?.rotate) {\n    urlParams.append(\"rotate\", params.rotate.toString());\n  }\n\n  const queryString = urlParams.toString();\n  return `${host}/${prefix}/${name}.svg${queryString ? \"?\" + queryString : \"\"}`;\n}\n\nexport function getIconSvgUrl(\n  iconName: string,\n  params?: Parameters<typeof buildIconSvgUrl>[2]\n): string {\n  return buildIconSvgUrl(currentHost, iconName, params);\n}\n\nexport async function downloadSvgAsText(\n  iconName: string,\n  params?: Parameters<typeof getIconSvgUrl>[1]\n): Promise<string> {\n  const url = getIconSvgUrl(iconName, params);\n  const response = await fetch(url);\n  if (!response.ok) {\n    throw new Error(`Failed to download SVG: ${response.statusText}`);\n  }\n  return await response.text();\n}\n\nexport function svgToFile(svgText: string, fileName: string): File {\n  const blob = new Blob([svgText], { type: \"image/svg+xml\" });\n  return new File([blob], fileName, { type: \"image/svg+xml\" });\n}\n\nexport const POPULAR_COLLECTIONS = {\n  general: [\n    { prefix: \"mdi\", name: \"Material Design Icons\" },\n    { prefix: \"ic\", name: \"Google Material Icons\" },\n    { prefix: \"ph\", name: \"Phosphor\" },\n    { prefix: \"heroicons\", name: \"Heroicons\" },\n    { prefix: \"lucide\", name: \"Lucide\" },\n    { prefix: \"tabler\", name: \"Tabler Icons\" },\n    { prefix: \"fe\", name: \"Feather Icons\" },\n    { prefix: \"bi\", name: \"Bootstrap Icons\" },\n  ],\n  brands: [\n    { prefix: \"simple-icons\", name: \"Simple Icons\" },\n    { prefix: \"logos\", name: \"SVG Logos\" },\n    { prefix: \"skill-icons\", name: \"Skill Icons\" },\n    { prefix: \"devicon\", name: \"Devicon\" },\n    { prefix: \"fa-brands\", name: \"Font Awesome Brands\" },\n  ],\n  emoji: [\n    { prefix: \"noto\", name: \"Noto Emoji\" },\n    { prefix: \"twemoji\", name: \"Twemoji\" },\n    { prefix: \"fluent-emoji\", name: \"Fluent Emoji\" },\n    { prefix: \"fluent-emoji-flat\", name: \"Fluent Emoji Flat\" },\n    { prefix: \"emojione\", name: \"EmojiOne\" },\n    { prefix: \"openmoji\", name: \"OpenMoji\" },\n  ],\n};\n\nexport function getCategoriesFromCollections(\n  collections: Record<string, IconSet>\n): string[] {\n  const categories = new Set<string>();\n  Object.values(collections).forEach((collection) => {\n    if (collection.category) {\n      categories.add(collection.category);\n    }\n  });\n  return Array.from(categories).sort();\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 595, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/lib/zk-encryption.ts"],"sourcesContent":["/**\r\n * True zero-knowledge encryption utilities\r\n * Keys are generated randomly in the browser and never derived from server secrets\r\n */\r\n\r\nexport interface ZeroKnowledgeEncryptionResult {\r\n  encryptedData: ArrayBuffer;\r\n  key: ArrayBuffer;\r\n  iv: ArrayBuffer;\r\n}\r\n\r\n/**\r\n * Encrypt data with a randomly generated key (true zero-knowledge)\r\n */\r\nexport async function encryptWithRandomKey(\r\n  data: ArrayBuffer\r\n): Promise<ZeroKnowledgeEncryptionResult> {\r\n  // Generate a truly random 256-bit key\r\n  const key = crypto.getRandomValues(new Uint8Array(32));\r\n\r\n  // Generate random IV\r\n  const iv = crypto.getRandomValues(new Uint8Array(12));\r\n\r\n  // Import the key for encryption\r\n  const cryptoKey = await crypto.subtle.importKey(\r\n    \"raw\",\r\n    key,\r\n    { name: \"AES-GCM\" },\r\n    false,\r\n    [\"encrypt\"]\r\n  );\r\n\r\n  // Encrypt the data\r\n  const encryptedResult = await crypto.subtle.encrypt(\r\n    { name: \"AES-GCM\", iv },\r\n    cryptoKey,\r\n    data\r\n  );\r\n\r\n  // For AES-GCM, we need to append the authentication tag\r\n  // The encrypted result contains both ciphertext and tag\r\n  return {\r\n    encryptedData: encryptedResult,\r\n    key: key.buffer,\r\n    iv: iv.buffer,\r\n  };\r\n}\r\n\r\n/**\r\n * Convert ArrayBuffer to base64 string for transmission\r\n */\r\nexport function arrayBufferToBase64(buffer: ArrayBuffer): string {\r\n  const bytes = new Uint8Array(buffer);\r\n  let binary = \"\";\r\n  for (let i = 0; i < bytes.byteLength; i++) {\r\n    binary += String.fromCharCode(bytes[i]);\r\n  }\r\n  return btoa(binary);\r\n}\r\n\r\n/**\r\n * Convert base64 string back to ArrayBuffer\r\n */\r\nexport function base64ToArrayBuffer(base64: string): ArrayBuffer {\r\n  const binary = atob(base64);\r\n  const bytes = new Uint8Array(binary.length);\r\n  for (let i = 0; i < binary.length; i++) {\r\n    bytes[i] = binary.charCodeAt(i);\r\n  }\r\n  return bytes.buffer;\r\n}\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;AAWM,eAAe,qBACpB,IAAiB;IAEjB,sCAAsC;IACtC,MAAM,MAAM,OAAO,eAAe,CAAC,IAAI,WAAW;IAElD,qBAAqB;IACrB,MAAM,KAAK,OAAO,eAAe,CAAC,IAAI,WAAW;IAEjD,gCAAgC;IAChC,MAAM,YAAY,MAAM,OAAO,MAAM,CAAC,SAAS,CAC7C,OACA,KACA;QAAE,MAAM;IAAU,GAClB,OACA;QAAC;KAAU;IAGb,mBAAmB;IACnB,MAAM,kBAAkB,MAAM,OAAO,MAAM,CAAC,OAAO,CACjD;QAAE,MAAM;QAAW;IAAG,GACtB,WACA;IAGF,wDAAwD;IACxD,wDAAwD;IACxD,OAAO;QACL,eAAe;QACf,KAAK,IAAI,MAAM;QACf,IAAI,GAAG,MAAM;IACf;AACF;AAKO,SAAS,oBAAoB,MAAmB;IACrD,MAAM,QAAQ,IAAI,WAAW;IAC7B,IAAI,SAAS;IACb,IAAK,IAAI,IAAI,GAAG,IAAI,MAAM,UAAU,EAAE,IAAK;QACzC,UAAU,OAAO,YAAY,CAAC,KAAK,CAAC,EAAE;IACxC;IACA,OAAO,KAAK;AACd;AAKO,SAAS,oBAAoB,MAAc;IAChD,MAAM,SAAS,KAAK;IACpB,MAAM,QAAQ,IAAI,WAAW,OAAO,MAAM;IAC1C,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;QACtC,KAAK,CAAC,EAAE,GAAG,OAAO,UAAU,CAAC;IAC/B;IACA,OAAO,MAAM,MAAM;AACrB","debugId":null}},
    {"offset": {"line": 652, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/lib/time.ts"],"sourcesContent":["// Time-related utility functions\n\nimport { DEFAULT_FPS } from \"@/stores/project-store\";\n\nexport type TimeCode = \"MM:SS\" | \"HH:MM:SS\" | \"HH:MM:SS:CS\" | \"HH:MM:SS:FF\";\n\n// Helper function to format time in various formats (MM:SS, HH:MM:SS, HH:MM:SS:CS, HH:MM:SS:FF)\nexport const formatTimeCode = (\n  timeInSeconds: number,\n  format: TimeCode = \"HH:MM:SS:CS\",\n  fps = DEFAULT_FPS\n): string => {\n  const hours = Math.floor(timeInSeconds / 3600);\n  const minutes = Math.floor((timeInSeconds % 3600) / 60);\n  const seconds = Math.floor(timeInSeconds % 60);\n  const centiseconds = Math.floor((timeInSeconds % 1) * 100);\n  const frames = Math.floor((timeInSeconds % 1) * fps);\n\n  switch (format) {\n    case \"MM:SS\":\n      return `${minutes.toString().padStart(2, \"0\")}:${seconds.toString().padStart(2, \"0\")}`;\n    case \"HH:MM:SS\":\n      return `${hours.toString().padStart(2, \"0\")}:${minutes.toString().padStart(2, \"0\")}:${seconds.toString().padStart(2, \"0\")}`;\n    case \"HH:MM:SS:CS\":\n      return `${hours.toString().padStart(2, \"0\")}:${minutes.toString().padStart(2, \"0\")}:${seconds.toString().padStart(2, \"0\")}:${centiseconds.toString().padStart(2, \"0\")}`;\n    case \"HH:MM:SS:FF\":\n      return `${hours.toString().padStart(2, \"0\")}:${minutes.toString().padStart(2, \"0\")}:${seconds.toString().padStart(2, \"0\")}:${frames.toString().padStart(2, \"0\")}`;\n  }\n};\n\nexport const parseTimeCode = (\n  timeCode: string,\n  format: TimeCode = \"HH:MM:SS:CS\",\n  fps = DEFAULT_FPS\n): number | null => {\n  if (!timeCode || typeof timeCode !== \"string\") return null;\n\n  // Remove any extra whitespace\n  const cleanTimeCode = timeCode.trim();\n\n  try {\n    switch (format) {\n      case \"MM:SS\": {\n        const parts = cleanTimeCode.split(\":\");\n        if (parts.length !== 2) return null;\n        const [minutes, seconds] = parts.map((part) => parseInt(part, 10));\n        if (isNaN(minutes) || isNaN(seconds)) return null;\n        if (minutes < 0 || seconds < 0 || seconds >= 60) return null;\n        return minutes * 60 + seconds;\n      }\n\n      case \"HH:MM:SS\": {\n        const parts = cleanTimeCode.split(\":\");\n        if (parts.length !== 3) return null;\n        const [hours, minutes, seconds] = parts.map((part) =>\n          parseInt(part, 10)\n        );\n        if (isNaN(hours) || isNaN(minutes) || isNaN(seconds)) return null;\n        if (\n          hours < 0 ||\n          minutes < 0 ||\n          seconds < 0 ||\n          minutes >= 60 ||\n          seconds >= 60\n        )\n          return null;\n        return hours * 3600 + minutes * 60 + seconds;\n      }\n\n      case \"HH:MM:SS:CS\": {\n        const parts = cleanTimeCode.split(\":\");\n        if (parts.length !== 4) return null;\n        const [hours, minutes, seconds, centiseconds] = parts.map((part) =>\n          parseInt(part, 10)\n        );\n        if (\n          isNaN(hours) ||\n          isNaN(minutes) ||\n          isNaN(seconds) ||\n          isNaN(centiseconds)\n        )\n          return null;\n        if (\n          hours < 0 ||\n          minutes < 0 ||\n          seconds < 0 ||\n          centiseconds < 0 ||\n          minutes >= 60 ||\n          seconds >= 60 ||\n          centiseconds >= 100\n        )\n          return null;\n        return hours * 3600 + minutes * 60 + seconds + centiseconds / 100;\n      }\n\n      case \"HH:MM:SS:FF\": {\n        const parts = cleanTimeCode.split(\":\");\n        if (parts.length !== 4) return null;\n        const [hours, minutes, seconds, frames] = parts.map((part) =>\n          parseInt(part, 10)\n        );\n        if (isNaN(hours) || isNaN(minutes) || isNaN(seconds) || isNaN(frames))\n          return null;\n        if (\n          hours < 0 ||\n          minutes < 0 ||\n          seconds < 0 ||\n          frames < 0 ||\n          minutes >= 60 ||\n          seconds >= 60 ||\n          frames >= fps\n        )\n          return null;\n        return hours * 3600 + minutes * 60 + seconds + frames / fps;\n      }\n    }\n  } catch {\n    return null;\n  }\n\n  return null;\n};\n\nexport const guessTimeCodeFormat = (timeCode: string): TimeCode | null => {\n  if (!timeCode || typeof timeCode !== \"string\") return null;\n\n  const numbers = timeCode.split(\":\");\n\n  if (!numbers.every((n) => !isNaN(Number(n)))) return null;\n\n  if (numbers.length === 2) return \"MM:SS\";\n  if (numbers.length === 3) return \"HH:MM:SS\";\n  // todo: how to tell frames apart from cs?\n  if (numbers.length === 4) return \"HH:MM:SS:FF\";\n\n  return null;\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 746, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/lib/canvas-gradients.ts"],"sourcesContent":["function splitBackgroundLayers(input: string): string[] {\n  const layers: string[] = [];\n  let depth = 0;\n  let start = 0;\n  for (let i = 0; i < input.length; i += 1) {\n    const ch = input[i] as string;\n    if (ch === \"(\") depth += 1;\n    else if (ch === \")\") depth -= 1;\n    else if (ch === \",\" && depth === 0) {\n      layers.push(input.slice(start, i).trim());\n      start = i + 1;\n    }\n  }\n  layers.push(input.slice(start).trim());\n  return layers;\n}\n\nfunction parseColorStop(stop: string): { color: string; position?: number } {\n  const s = stop.trim();\n\n  // Handle functional colors like rgba(), rgb(), hsla(), hsl()\n  const colorFunctions = [\"rgba(\", \"rgb(\", \"hsla(\", \"hsl(\"];\n  let color = \"\";\n  let remaining = \"\";\n\n  for (const fn of colorFunctions) {\n    if (s.startsWith(fn)) {\n      let depth = 0;\n      for (let i = 0; i < s.length; i += 1) {\n        const ch = s[i] as string;\n        if (ch === \"(\") depth += 1;\n        else if (ch === \")\") {\n          depth -= 1;\n          if (depth === 0) {\n            color = s.slice(0, i + 1);\n            remaining = s.slice(i + 1).trim();\n            break;\n          }\n        }\n      }\n      break;\n    }\n  }\n\n  if (!color) {\n    const parts = s.split(/\\s+/);\n    color = parts[0] as string;\n    remaining = parts.slice(1).join(\" \");\n  }\n\n  // Convert transparent to transparent white for better blending\n  if (color === \"transparent\") {\n    color = \"rgba(255, 255, 255, 0)\";\n  }\n\n  // Parse position if present\n  let position: number | undefined;\n  if (remaining) {\n    const posMatch = remaining.match(/(\\d+(?:\\.\\d+)?)%/);\n    if (posMatch) {\n      position = parseFloat(posMatch[1] as string) / 100;\n    }\n  }\n\n  return { color, position };\n}\n\nfunction parseLinearGradient(layer: string, width: number, height: number) {\n  const inside = layer.slice(layer.indexOf(\"(\") + 1, layer.lastIndexOf(\")\"));\n  const parts = splitBackgroundLayers(inside);\n  const dir = (parts.shift() || \"\").trim();\n\n  let x0 = 0,\n    y0 = 0,\n    x1 = width,\n    y1 = 0; // default: to right\n\n  if (dir.endsWith(\"deg\")) {\n    const deg = parseFloat(dir);\n    const rad = (deg * Math.PI) / 180;\n    const cx = width / 2;\n    const cy = height / 2;\n    const r = Math.hypot(width, height) / 2;\n    x0 = cx - Math.cos(rad) * r;\n    y0 = cy - Math.sin(rad) * r;\n    x1 = cx + Math.cos(rad) * r;\n    y1 = cy + Math.sin(rad) * r;\n  } else if (dir.startsWith(\"to \")) {\n    const d = dir.slice(3).trim();\n    if (d === \"right\") {\n      x0 = 0;\n      y0 = 0;\n      x1 = width;\n      y1 = 0;\n    } else if (d === \"left\") {\n      x0 = width;\n      y0 = 0;\n      x1 = 0;\n      y1 = 0;\n    } else if (d === \"bottom\") {\n      x0 = 0;\n      y0 = 0;\n      x1 = 0;\n      y1 = height;\n    } else if (d === \"top\") {\n      x0 = 0;\n      y0 = height;\n      x1 = 0;\n      y1 = 0;\n    }\n  } else {\n    // No direction specified, treat as first color\n    parts.unshift(dir);\n  }\n\n  return { x0, y0, x1, y1, colors: parts };\n}\n\nfunction parseRadialGradient(layer: string, width: number, height: number) {\n  const inside = layer.slice(layer.indexOf(\"(\") + 1, layer.lastIndexOf(\")\"));\n  const parts = splitBackgroundLayers(inside);\n  const first = (parts.shift() || \"\").trim();\n\n  let cx = width / 2;\n  let cy = height / 2;\n\n  if (first.startsWith(\"circle at\")) {\n    const pos = first.replace(\"circle at\", \"\").trim();\n    const coords = pos.split(/\\s+/);\n\n    for (let i = 0; i < coords.length; i += 1) {\n      const coord = coords[i] as string;\n      if (coord.endsWith(\"%\")) {\n        const val = parseFloat(coord) / 100;\n        if (i === 0) cx = val * width;\n        else if (i === 1) cy = val * height;\n      } else if (coord === \"left\") cx = 0;\n      else if (coord === \"right\") cx = width;\n      else if (coord === \"top\") cy = 0;\n      else if (coord === \"bottom\") cy = height;\n      else if (coord === \"center\") {\n        if (i === 0) cx = width / 2;\n        else if (i === 1) cy = height / 2;\n      }\n    }\n  } else {\n    parts.unshift(first);\n  }\n\n  // Use farthest-corner for radius\n  const r = Math.max(\n    Math.hypot(cx, cy),\n    Math.hypot(width - cx, cy),\n    Math.hypot(cx, height - cy),\n    Math.hypot(width - cx, height - cy)\n  );\n\n  return { cx, cy, r, colors: parts };\n}\n\nexport function drawCssBackground(\n  ctx: CanvasRenderingContext2D,\n  width: number,\n  height: number,\n  css: string\n): void {\n  const layers = splitBackgroundLayers(css).filter(Boolean);\n\n  // Draw layers from last to first (CSS background order)\n  for (let i = layers.length - 1; i >= 0; i -= 1) {\n    const layer = layers[i] as string;\n\n    if (layer.startsWith(\"linear-gradient(\")) {\n      const { x0, y0, x1, y1, colors } = parseLinearGradient(\n        layer,\n        width,\n        height\n      );\n      const grad = ctx.createLinearGradient(x0, y0, x1, y1);\n      const colorStops = colors.map((c) => parseColorStop(c as string));\n\n      // Handle positions properly\n      for (let j = 0; j < colorStops.length; j += 1) {\n        const stop = colorStops[j] as { color: string; position?: number };\n        const pos = stop.position ?? j / Math.max(1, colorStops.length - 1);\n        grad.addColorStop(Math.max(0, Math.min(1, pos)), stop.color);\n      }\n\n      ctx.fillStyle = grad;\n      ctx.fillRect(0, 0, width, height);\n    } else if (layer.startsWith(\"radial-gradient(\")) {\n      const { cx, cy, r, colors } = parseRadialGradient(layer, width, height);\n      const grad = ctx.createRadialGradient(cx, cy, 0, cx, cy, r);\n      const colorStops = colors.map((c) => parseColorStop(c as string));\n\n      // Handle positions properly\n      for (let j = 0; j < colorStops.length; j += 1) {\n        const stop = colorStops[j] as { color: string; position?: number };\n        const pos = stop.position ?? j / Math.max(1, colorStops.length - 1);\n        grad.addColorStop(Math.max(0, Math.min(1, pos)), stop.color);\n      }\n\n      ctx.fillStyle = grad;\n      ctx.fillRect(0, 0, width, height);\n    } else if (\n      layer.startsWith(\"#\") ||\n      layer.startsWith(\"rgb\") ||\n      layer.startsWith(\"hsl\") ||\n      layer === \"transparent\" ||\n      layer === \"white\" ||\n      layer === \"black\"\n    ) {\n      if (layer !== \"transparent\") {\n        ctx.fillStyle = layer;\n        ctx.fillRect(0, 0, width, height);\n      }\n    }\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 950, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/lib/timeline-renderer.ts"],"sourcesContent":["import type { TimelineTrack } from \"@/types/timeline\";\nimport type { MediaFile } from \"@/types/media\";\nimport type { BlurIntensity } from \"@/types/project\";\nimport { videoCache } from \"./video-cache\";\nimport { drawCssBackground } from \"./canvas-gradients\";\n\nexport interface RenderContext {\n  ctx: CanvasRenderingContext2D;\n  time: number;\n  canvasWidth: number;\n  canvasHeight: number;\n  tracks: TimelineTrack[];\n  mediaFiles: MediaFile[];\n  backgroundColor?: string;\n  backgroundType?: \"color\" | \"blur\";\n  blurIntensity?: BlurIntensity;\n  projectCanvasSize?: { width: number; height: number };\n}\n\nconst imageElementCache = new Map<string, HTMLImageElement>();\n\nasync function getImageElement(\n  mediaItem: MediaFile\n): Promise<HTMLImageElement> {\n  const cacheKey = mediaItem.id;\n  const cached = imageElementCache.get(cacheKey);\n  if (cached) return cached;\n  const img = new Image();\n  await new Promise<void>((resolve, reject) => {\n    img.onload = () => resolve();\n    img.onerror = () => reject(new Error(\"Image load failed\"));\n    img.src = mediaItem.url || URL.createObjectURL(mediaItem.file);\n  });\n  imageElementCache.set(cacheKey, img);\n  return img;\n}\n\nexport async function renderTimelineFrame({\n  ctx,\n  time,\n  canvasWidth,\n  canvasHeight,\n  tracks,\n  mediaFiles,\n  backgroundColor,\n  backgroundType,\n  blurIntensity,\n  projectCanvasSize,\n}: RenderContext): Promise<void> {\n  // Background\n  ctx.clearRect(0, 0, canvasWidth, canvasHeight);\n  if (\n    backgroundColor &&\n    backgroundColor !== \"transparent\" &&\n    !backgroundColor.includes(\"gradient\")\n  ) {\n    ctx.fillStyle = backgroundColor;\n    ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n  }\n\n  // If backgroundColor is a CSS gradient string, draw it\n  if (backgroundColor && backgroundColor.includes(\"gradient\")) {\n    drawCssBackground(ctx, canvasWidth, canvasHeight, backgroundColor);\n  }\n\n  const scaleX = projectCanvasSize ? canvasWidth / projectCanvasSize.width : 1;\n  const scaleY = projectCanvasSize\n    ? canvasHeight / projectCanvasSize.height\n    : 1;\n  const idToMedia = new Map(mediaFiles.map((m) => [m.id, m] as const));\n  const active: Array<{\n    track: TimelineTrack;\n    element: TimelineTrack[\"elements\"][number];\n    mediaItem: MediaFile | null;\n  }> = [];\n\n  for (let t = tracks.length - 1; t >= 0; t -= 1) {\n    const track = tracks[t];\n    for (const element of track.elements) {\n      if (element.hidden) continue;\n      const elementStart = element.startTime;\n      const elementEnd =\n        element.startTime +\n        (element.duration - element.trimStart - element.trimEnd);\n      if (time >= elementStart && time < elementEnd) {\n        let mediaItem: MediaFile | null = null;\n        if (element.type === \"media\") {\n          mediaItem =\n            element.mediaId === \"test\"\n              ? null\n              : idToMedia.get(element.mediaId) || null;\n        }\n        active.push({ track, element, mediaItem });\n      }\n    }\n  }\n\n  // If background is set to blur, draw the active media as a blurred cover layer first\n  if (backgroundType === \"blur\") {\n    const blurPx = Math.max(0, blurIntensity ?? 8);\n    // Find a suitable media element (video/image) among active elements\n    const bgCandidate = active.find(({ element, mediaItem }) => {\n      return (\n        element.type === \"media\" &&\n        mediaItem !== null &&\n        (mediaItem.type === \"video\" || mediaItem.type === \"image\")\n      );\n    });\n    if (bgCandidate && bgCandidate.mediaItem) {\n      const { element, mediaItem } = bgCandidate;\n      try {\n        if (mediaItem.type === \"video\") {\n          const localTime = time - element.startTime + element.trimStart;\n          const frame = await videoCache.getFrameAt(\n            mediaItem.id,\n            mediaItem.file,\n            Math.max(0, localTime)\n          );\n          if (frame) {\n            const mediaW = Math.max(1, mediaItem.width || canvasWidth);\n            const mediaH = Math.max(1, mediaItem.height || canvasHeight);\n            const coverScale = Math.max(\n              canvasWidth / mediaW,\n              canvasHeight / mediaH\n            );\n            const drawW = mediaW * coverScale;\n            const drawH = mediaH * coverScale;\n            const drawX = (canvasWidth - drawW) / 2;\n            const drawY = (canvasHeight - drawH) / 2;\n            ctx.save();\n            ctx.filter = `blur(${blurPx}px)`;\n            ctx.drawImage(frame.canvas, drawX, drawY, drawW, drawH);\n            ctx.restore();\n          }\n        } else if (mediaItem.type === \"image\") {\n          const img = await getImageElement(mediaItem);\n          const mediaW = Math.max(\n            1,\n            mediaItem.width || img.naturalWidth || canvasWidth\n          );\n          const mediaH = Math.max(\n            1,\n            mediaItem.height || img.naturalHeight || canvasHeight\n          );\n          const coverScale = Math.max(\n            canvasWidth / mediaW,\n            canvasHeight / mediaH\n          );\n          const drawW = mediaW * coverScale;\n          const drawH = mediaH * coverScale;\n          const drawX = (canvasWidth - drawW) / 2;\n          const drawY = (canvasHeight - drawH) / 2;\n          ctx.save();\n          ctx.filter = `blur(${blurPx}px)`;\n          ctx.drawImage(img, drawX, drawY, drawW, drawH);\n          ctx.restore();\n        }\n      } catch {\n        // Ignore background blur failures; foreground will still render\n      }\n    }\n  }\n\n  for (const { element, mediaItem } of active) {\n    if (element.type === \"media\" && mediaItem) {\n      if (mediaItem.type === \"video\") {\n        try {\n          const localTime = time - element.startTime + element.trimStart;\n\n          const frame = await videoCache.getFrameAt(\n            mediaItem.id,\n            mediaItem.file,\n            localTime\n          );\n          if (!frame) continue;\n\n          const mediaW = Math.max(1, mediaItem.width || canvasWidth);\n          const mediaH = Math.max(1, mediaItem.height || canvasHeight);\n          const containScale = Math.min(\n            canvasWidth / mediaW,\n            canvasHeight / mediaH\n          );\n          const drawW = mediaW * containScale;\n          const drawH = mediaH * containScale;\n          const drawX = (canvasWidth - drawW) / 2;\n          const drawY = (canvasHeight - drawH) / 2;\n\n          ctx.drawImage(frame.canvas, drawX, drawY, drawW, drawH);\n        } catch (error) {\n          console.warn(\n            `Failed to render video frame for ${mediaItem.name}:`,\n            error\n          );\n        }\n      }\n      if (mediaItem.type === \"image\") {\n        const img = new Image();\n        await new Promise<void>((resolve, reject) => {\n          img.onload = () => resolve();\n          img.onerror = () => reject(new Error(\"Image load failed\"));\n          img.src = mediaItem.url || URL.createObjectURL(mediaItem.file);\n        });\n        const mediaW = Math.max(\n          1,\n          mediaItem.width || img.naturalWidth || canvasWidth\n        );\n        const mediaH = Math.max(\n          1,\n          mediaItem.height || img.naturalHeight || canvasHeight\n        );\n        const containScale = Math.min(\n          canvasWidth / mediaW,\n          canvasHeight / mediaH\n        );\n        const drawW = mediaW * containScale;\n        const drawH = mediaH * containScale;\n        const drawX = (canvasWidth - drawW) / 2;\n        const drawY = (canvasHeight - drawH) / 2;\n        ctx.drawImage(img, drawX, drawY, drawW, drawH);\n      }\n    }\n    if (element.type === \"text\") {\n      const text = element;\n      const posX = canvasWidth / 2 + text.x * scaleX;\n      const posY = canvasHeight / 2 + text.y * scaleY;\n      ctx.save();\n      ctx.translate(posX, posY);\n      ctx.rotate((text.rotation * Math.PI) / 180);\n      ctx.globalAlpha = Math.max(0, Math.min(1, text.opacity));\n      const px = text.fontSize * scaleX;\n      const weight = text.fontWeight === \"bold\" ? \"bold \" : \"\";\n      const style = text.fontStyle === \"italic\" ? \"italic \" : \"\";\n      ctx.font = `${style}${weight}${px}px ${text.fontFamily}`;\n      ctx.fillStyle = text.color;\n      ctx.textAlign = text.textAlign as CanvasTextAlign;\n      ctx.textBaseline = \"middle\";\n      const metrics = ctx.measureText(text.content);\n      const hasBoxMetrics =\n        \"actualBoundingBoxAscent\" in metrics &&\n        \"actualBoundingBoxDescent\" in metrics;\n      const ascent = hasBoxMetrics\n        ? (\n            metrics as TextMetrics & {\n              actualBoundingBoxAscent: number;\n              actualBoundingBoxDescent: number;\n            }\n          ).actualBoundingBoxAscent\n        : px * 0.8;\n      const descent = hasBoxMetrics\n        ? (\n            metrics as TextMetrics & {\n              actualBoundingBoxAscent: number;\n              actualBoundingBoxDescent: number;\n            }\n          ).actualBoundingBoxDescent\n        : px * 0.2;\n      const textW = metrics.width;\n      const textH = ascent + descent;\n      const padX = 8 * scaleX;\n      const padY = 4 * scaleX;\n      if (text.backgroundColor) {\n        ctx.save();\n        ctx.fillStyle = text.backgroundColor;\n        let bgLeft = -textW / 2;\n        if (ctx.textAlign === \"left\") bgLeft = 0;\n        if (ctx.textAlign === \"right\") bgLeft = -textW;\n        ctx.fillRect(\n          bgLeft - padX,\n          -textH / 2 - padY,\n          textW + padX * 2,\n          textH + padY * 2\n        );\n        ctx.restore();\n      }\n      ctx.fillText(text.content, 0, 0);\n      ctx.restore();\n    }\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1137, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/lib/export.ts"],"sourcesContent":["import {\n  Output,\n  Mp4OutputFormat,\n  WebMOutputFormat,\n  BufferTarget,\n  CanvasSource,\n  AudioBufferSource,\n  QUALITY_LOW,\n  QUALITY_MEDIUM,\n  QUALITY_HIGH,\n  QUALITY_VERY_HIGH,\n} from \"mediabunny\";\nimport { renderTimelineFrame } from \"./timeline-renderer\";\nimport { useTimelineStore } from \"@/stores/timeline-store\";\nimport { useMediaStore } from \"@/stores/media-store\";\nimport { useProjectStore } from \"@/stores/project-store\";\nimport { DEFAULT_FPS, DEFAULT_CANVAS_SIZE } from \"@/stores/project-store\";\nimport { ExportOptions, ExportResult } from \"@/types/export\";\nimport { TimelineTrack } from \"@/types/timeline\";\nimport { MediaFile } from \"@/types/media\";\n\nexport const DEFAULT_EXPORT_OPTIONS: ExportOptions = {\n  format: \"mp4\",\n  quality: \"high\",\n  includeAudio: true,\n};\n\nconst qualityMap = {\n  low: QUALITY_LOW,\n  medium: QUALITY_MEDIUM,\n  high: QUALITY_HIGH,\n  very_high: QUALITY_VERY_HIGH,\n};\n\ninterface AudioElement {\n  buffer: AudioBuffer;\n  startTime: number;\n  duration: number;\n  trimStart: number;\n  trimEnd: number;\n  muted: boolean;\n}\n\nasync function createTimelineAudioBuffer(\n  tracks: TimelineTrack[],\n  mediaFiles: MediaFile[],\n  duration: number,\n  sampleRate: number = 44100\n): Promise<AudioBuffer | null> {\n  // Get Web Audio context\n  const audioContext = new (window.AudioContext ||\n    (window as any).webkitAudioContext)();\n\n  // Collect all audio elements from timeline\n  const audioElements: AudioElement[] = [];\n  const mediaMap = new Map<string, MediaFile>(mediaFiles.map((m) => [m.id, m]));\n\n  for (const track of tracks) {\n    if (track.muted) continue;\n\n    for (const element of track.elements) {\n      if (element.type !== \"media\") continue;\n\n      const mediaElement = element;\n      const mediaItem = mediaMap.get(mediaElement.mediaId);\n      if (!mediaItem || mediaItem.type !== \"audio\") continue;\n\n      const visibleDuration =\n        mediaElement.duration - mediaElement.trimStart - mediaElement.trimEnd;\n      if (visibleDuration <= 0) continue;\n\n      try {\n        // Decode audio file\n        const arrayBuffer = await mediaItem.file.arrayBuffer();\n        const audioBuffer = await audioContext.decodeAudioData(\n          arrayBuffer.slice(0)\n        );\n\n        audioElements.push({\n          buffer: audioBuffer,\n          startTime: mediaElement.startTime,\n          duration: mediaElement.duration,\n          trimStart: mediaElement.trimStart,\n          trimEnd: mediaElement.trimEnd,\n          muted: mediaElement.muted || track.muted || false,\n        });\n      } catch (error) {\n        console.warn(`Failed to decode audio file ${mediaItem.name}:`, error);\n      }\n    }\n  }\n\n  if (audioElements.length === 0) {\n    return null; // No audio to mix\n  }\n\n  // Create output buffer\n  const outputChannels = 2; // Stereo\n  const outputLength = Math.ceil(duration * sampleRate);\n  const outputBuffer = audioContext.createBuffer(\n    outputChannels,\n    outputLength,\n    sampleRate\n  );\n\n  // Mix all audio elements\n  for (const element of audioElements) {\n    if (element.muted) continue;\n\n    const {\n      buffer,\n      startTime,\n      trimStart,\n      trimEnd,\n      duration: elementDuration,\n    } = element;\n\n    // Calculate timing\n    const sourceStartSample = Math.floor(trimStart * buffer.sampleRate);\n    const sourceDuration = elementDuration - trimStart - trimEnd;\n    const sourceLengthSamples = Math.floor(sourceDuration * buffer.sampleRate);\n    const outputStartSample = Math.floor(startTime * sampleRate);\n\n    // Resample if needed (simple approach)\n    const resampleRatio = sampleRate / buffer.sampleRate;\n    const resampledLength = Math.floor(sourceLengthSamples * resampleRatio);\n\n    // Mix each channel\n    for (let channel = 0; channel < outputChannels; channel++) {\n      const outputData = outputBuffer.getChannelData(channel);\n      const sourceChannel = Math.min(channel, buffer.numberOfChannels - 1);\n      const sourceData = buffer.getChannelData(sourceChannel);\n\n      for (let i = 0; i < resampledLength; i++) {\n        const outputIndex = outputStartSample + i;\n        if (outputIndex >= outputLength) break;\n\n        // Simple resampling (could be improved with proper interpolation)\n        const sourceIndex = sourceStartSample + Math.floor(i / resampleRatio);\n        if (sourceIndex >= sourceData.length) break;\n\n        outputData[outputIndex] += sourceData[sourceIndex];\n      }\n    }\n  }\n\n  return outputBuffer;\n}\n\nexport async function exportProject(\n  options: ExportOptions\n): Promise<ExportResult> {\n  const { format, quality, fps, includeAudio, onProgress, onCancel } = options;\n\n  try {\n    const timelineStore = useTimelineStore.getState();\n    const mediaStore = useMediaStore.getState();\n    const projectStore = useProjectStore.getState();\n\n    const { tracks, getTotalDuration } = timelineStore;\n    const { mediaFiles } = mediaStore;\n    const { activeProject } = projectStore;\n\n    if (!activeProject) {\n      return { success: false, error: \"No active project\" };\n    }\n\n    const duration = getTotalDuration();\n    if (duration === 0) {\n      return { success: false, error: \"Project is empty\" };\n    }\n\n    const exportFps = fps || activeProject.fps || DEFAULT_FPS;\n    const canvasSize = activeProject.canvasSize || DEFAULT_CANVAS_SIZE;\n\n    const outputFormat =\n      format === \"webm\" ? new WebMOutputFormat() : new Mp4OutputFormat();\n\n    // BufferTarget for smaller files, StreamTarget for larger ones\n    // TODO: Implement StreamTarget\n    const output = new Output({\n      format: outputFormat,\n      target: new BufferTarget(),\n    });\n\n    // Canvas for rendering\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = canvasSize.width;\n    canvas.height = canvasSize.height;\n    const ctx = canvas.getContext(\"2d\");\n\n    if (!ctx) {\n      return { success: false, error: \"Failed to create canvas context\" };\n    }\n\n    const videoSource = new CanvasSource(canvas, {\n      codec: format === \"webm\" ? \"vp9\" : \"avc\", // VP9 for WebM, H.264 for MP4\n      bitrate: qualityMap[quality],\n    });\n\n    output.addVideoTrack(videoSource, { frameRate: exportFps });\n\n    // Add audio track if requested (but don't add data yet)\n    let audioSource: AudioBufferSource | null = null;\n    let audioBuffer: AudioBuffer | null = null;\n\n    if (includeAudio) {\n      onProgress?.(0.05); // 5% for audio processing\n\n      audioBuffer = await createTimelineAudioBuffer(\n        tracks,\n        mediaFiles,\n        duration\n      );\n\n      if (audioBuffer) {\n        audioSource = new AudioBufferSource({\n          codec: format === \"webm\" ? \"opus\" : \"aac\", // Opus for WebM, AAC for MP4\n          bitrate: qualityMap[quality], // Use same quality for audio\n        });\n\n        output.addAudioTrack(audioSource);\n      }\n    }\n\n    // Start the output (after all tracks are added)\n    await output.start();\n\n    // Now add audio data after starting\n    if (audioSource && audioBuffer) {\n      await audioSource.add(audioBuffer);\n      audioSource.close();\n    }\n\n    const totalFrames = Math.ceil(duration * exportFps);\n    let cancelled = false;\n\n    // Render each frame\n    for (let frameIndex = 0; frameIndex < totalFrames; frameIndex++) {\n      // Check for cancellation\n      if (onCancel?.()) {\n        cancelled = true;\n        break;\n      }\n\n      const time = frameIndex / exportFps;\n\n      await renderTimelineFrame({\n        ctx,\n        time,\n        canvasWidth: canvas.width,\n        canvasHeight: canvas.height,\n        tracks,\n        mediaFiles,\n        backgroundType: activeProject.backgroundType,\n        blurIntensity: activeProject.blurIntensity,\n        backgroundColor:\n          activeProject.backgroundType === \"blur\"\n            ? undefined\n            : activeProject.backgroundColor || \"#000000\",\n        projectCanvasSize: canvasSize,\n      });\n\n      const frameDuration = 1 / exportFps;\n      await videoSource.add(time, frameDuration);\n\n      // Adjust progress to account for audio processing (5% at start)\n      const videoProgress = includeAudio\n        ? 0.05 + (frameIndex / totalFrames) * 0.95\n        : frameIndex / totalFrames;\n      onProgress?.(videoProgress);\n    }\n\n    if (cancelled) {\n      await output.cancel();\n      return { success: false, cancelled: true };\n    }\n    videoSource.close();\n    await output.finalize();\n    onProgress?.(1);\n\n    return {\n      success: true,\n      buffer: output.target.buffer || undefined,\n    };\n  } catch (error) {\n    console.error(\"Export failed:\", error);\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : \"Unknown export error\",\n    };\n  }\n}\n\nexport function getExportMimeType(format: \"mp4\" | \"webm\"): string {\n  return format === \"webm\" ? \"video/webm\" : \"video/mp4\";\n}\n\nexport function getExportFileExtension(format: \"mp4\" | \"webm\"): string {\n  return `.${format}`;\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1376, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/stores/panel-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\n\nexport type PanelPreset =\n  | \"default\"\n  | \"media\"\n  | \"inspector\"\n  | \"vertical-preview\";\n\ninterface PanelSizes {\n  toolsPanel: number;\n  previewPanel: number;\n  propertiesPanel: number;\n  mainContent: number;\n  timeline: number;\n}\n\nexport const PRESET_CONFIGS: Record<PanelPreset, PanelSizes> = {\n  default: {\n    toolsPanel: 25,\n    previewPanel: 50,\n    propertiesPanel: 25,\n    mainContent: 70,\n    timeline: 30,\n  },\n  media: {\n    toolsPanel: 30,\n    previewPanel: 45,\n    propertiesPanel: 25,\n    mainContent: 100,\n    timeline: 25,\n  },\n  inspector: {\n    toolsPanel: 30,\n    previewPanel: 70,\n    propertiesPanel: 30,\n    mainContent: 75,\n    timeline: 25,\n  },\n  \"vertical-preview\": {\n    toolsPanel: 30,\n    previewPanel: 40,\n    propertiesPanel: 30,\n    mainContent: 75,\n    timeline: 25,\n  },\n};\n\ninterface PanelState extends PanelSizes {\n  activePreset: PanelPreset;\n  presetCustomSizes: Record<PanelPreset, Partial<PanelSizes>>;\n  resetCounter: number;\n\n  mediaViewMode: \"grid\" | \"list\";\n\n  setToolsPanel: (size: number) => void;\n  setPreviewPanel: (size: number) => void;\n  setPropertiesPanel: (size: number) => void;\n  setMainContent: (size: number) => void;\n  setTimeline: (size: number) => void;\n  setMediaViewMode: (mode: \"grid\" | \"list\") => void;\n\n  setActivePreset: (preset: PanelPreset) => void;\n  resetPreset: (preset: PanelPreset) => void;\n  getCurrentPresetSizes: () => PanelSizes;\n}\n\nexport const usePanelStore = create<PanelState>()(\n  persist(\n    (set, get) => ({\n      ...PRESET_CONFIGS.default,\n      activePreset: \"default\" as PanelPreset,\n      presetCustomSizes: {\n        default: {},\n        media: {},\n        inspector: {},\n        \"vertical-preview\": {},\n      },\n      resetCounter: 0,\n\n      mediaViewMode: \"grid\" as const,\n\n      setToolsPanel: (size) => {\n        const { activePreset, presetCustomSizes } = get();\n        set({\n          toolsPanel: size,\n          presetCustomSizes: {\n            ...presetCustomSizes,\n            [activePreset]: {\n              ...presetCustomSizes[activePreset],\n              toolsPanel: size,\n            },\n          },\n        });\n      },\n      setPreviewPanel: (size) => {\n        const { activePreset, presetCustomSizes } = get();\n        set({\n          previewPanel: size,\n          presetCustomSizes: {\n            ...presetCustomSizes,\n            [activePreset]: {\n              ...presetCustomSizes[activePreset],\n              previewPanel: size,\n            },\n          },\n        });\n      },\n      setPropertiesPanel: (size) => {\n        const { activePreset, presetCustomSizes } = get();\n        set({\n          propertiesPanel: size,\n          presetCustomSizes: {\n            ...presetCustomSizes,\n            [activePreset]: {\n              ...presetCustomSizes[activePreset],\n              propertiesPanel: size,\n            },\n          },\n        });\n      },\n      setMainContent: (size) => {\n        const { activePreset, presetCustomSizes } = get();\n        set({\n          mainContent: size,\n          presetCustomSizes: {\n            ...presetCustomSizes,\n            [activePreset]: {\n              ...presetCustomSizes[activePreset],\n              mainContent: size,\n            },\n          },\n        });\n      },\n      setTimeline: (size) => {\n        const { activePreset, presetCustomSizes } = get();\n        set({\n          timeline: size,\n          presetCustomSizes: {\n            ...presetCustomSizes,\n            [activePreset]: {\n              ...presetCustomSizes[activePreset],\n              timeline: size,\n            },\n          },\n        });\n      },\n      setMediaViewMode: (mode) => set({ mediaViewMode: mode }),\n\n      setActivePreset: (preset) => {\n        const {\n          activePreset: currentPreset,\n          presetCustomSizes,\n          toolsPanel,\n          previewPanel,\n          propertiesPanel,\n          mainContent,\n          timeline,\n        } = get();\n\n        const updatedPresetCustomSizes = {\n          ...presetCustomSizes,\n          [currentPreset]: {\n            toolsPanel,\n            previewPanel,\n            propertiesPanel,\n            mainContent,\n            timeline,\n          },\n        };\n\n        const defaultSizes = PRESET_CONFIGS[preset];\n        const customSizes = updatedPresetCustomSizes[preset] || {};\n        const finalSizes = { ...defaultSizes, ...customSizes } as PanelSizes;\n\n        set({\n          activePreset: preset,\n          presetCustomSizes: updatedPresetCustomSizes,\n          ...finalSizes,\n        });\n      },\n\n      resetPreset: (preset) => {\n        const { presetCustomSizes, activePreset, resetCounter } = get();\n        const defaultSizes = PRESET_CONFIGS[preset];\n\n        const newPresetCustomSizes = {\n          ...presetCustomSizes,\n          [preset]: {},\n        };\n\n        const updates: Partial<PanelState> = {\n          presetCustomSizes: newPresetCustomSizes,\n          resetCounter: resetCounter + 1,\n        };\n\n        if (preset === activePreset) {\n          Object.assign(updates, defaultSizes);\n        }\n\n        set(updates);\n      },\n\n      getCurrentPresetSizes: () => {\n        const {\n          toolsPanel,\n          previewPanel,\n          propertiesPanel,\n          mainContent,\n          timeline,\n        } = get();\n        return {\n          toolsPanel,\n          previewPanel,\n          propertiesPanel,\n          mainContent,\n          timeline,\n        };\n      },\n    }),\n    {\n      name: \"panel-sizes\",\n    }\n  )\n);\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1555, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/stores/sounds-store.ts"],"sourcesContent":["import { create } from \"zustand\";\r\nimport type { SoundEffect, SavedSound } from \"@/types/sounds\";\r\nimport { storageService } from \"@/lib/storage/storage-service\";\r\nimport { toast } from \"sonner\";\r\nimport { useMediaStore } from \"./media-store\";\r\nimport { useTimelineStore } from \"./timeline-store\";\r\nimport { useProjectStore } from \"./project-store\";\r\nimport { usePlaybackStore } from \"./playback-store\";\r\n\r\ninterface SoundsStore {\r\n  topSoundEffects: SoundEffect[];\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  hasLoaded: boolean;\r\n\r\n  // Filter state\r\n  showCommercialOnly: boolean;\r\n  toggleCommercialFilter: () => void;\r\n\r\n  // Search state\r\n  searchQuery: string;\r\n  searchResults: SoundEffect[];\r\n  isSearching: boolean;\r\n  searchError: string | null;\r\n  lastSearchQuery: string;\r\n  scrollPosition: number;\r\n\r\n  // Pagination state\r\n  currentPage: number;\r\n  hasNextPage: boolean;\r\n  totalCount: number;\r\n  isLoadingMore: boolean;\r\n\r\n  // Saved sounds state\r\n  savedSounds: SavedSound[];\r\n  isSavedSoundsLoaded: boolean;\r\n  isLoadingSavedSounds: boolean;\r\n  savedSoundsError: string | null;\r\n\r\n  // Timeline integration\r\n  addSoundToTimeline: (sound: SoundEffect) => Promise<boolean>;\r\n\r\n  setTopSoundEffects: (sounds: SoundEffect[]) => void;\r\n  setLoading: (loading: boolean) => void;\r\n  setError: (error: string | null) => void;\r\n  setHasLoaded: (loaded: boolean) => void;\r\n\r\n  // Search actions\r\n  setSearchQuery: (query: string) => void;\r\n  setSearchResults: (results: SoundEffect[]) => void;\r\n  setSearching: (searching: boolean) => void;\r\n  setSearchError: (error: string | null) => void;\r\n  setLastSearchQuery: (query: string) => void;\r\n  setScrollPosition: (position: number) => void;\r\n\r\n  // Pagination actions\r\n  setCurrentPage: (page: number) => void;\r\n  setHasNextPage: (hasNext: boolean) => void;\r\n  setTotalCount: (count: number) => void;\r\n  setLoadingMore: (loading: boolean) => void;\r\n  appendSearchResults: (results: SoundEffect[]) => void;\r\n  appendTopSounds: (results: SoundEffect[]) => void;\r\n  resetPagination: () => void;\r\n\r\n  // Saved sounds actions\r\n  loadSavedSounds: () => Promise<void>;\r\n  saveSoundEffect: (soundEffect: SoundEffect) => Promise<void>;\r\n  removeSavedSound: (soundId: number) => Promise<void>;\r\n  isSoundSaved: (soundId: number) => boolean;\r\n  toggleSavedSound: (soundEffect: SoundEffect) => Promise<void>;\r\n  clearSavedSounds: () => Promise<void>;\r\n}\r\n\r\nexport const useSoundsStore = create<SoundsStore>((set, get) => ({\r\n  topSoundEffects: [],\r\n  isLoading: false,\r\n  error: null,\r\n  hasLoaded: false,\r\n  showCommercialOnly: true,\r\n\r\n  toggleCommercialFilter: () => {\r\n    set((state) => ({ showCommercialOnly: !state.showCommercialOnly }));\r\n  },\r\n\r\n  // Search state\r\n  searchQuery: \"\",\r\n  searchResults: [],\r\n  isSearching: false,\r\n  searchError: null,\r\n  lastSearchQuery: \"\",\r\n  scrollPosition: 0,\r\n\r\n  // Pagination state\r\n  currentPage: 1,\r\n  hasNextPage: false,\r\n  totalCount: 0,\r\n  isLoadingMore: false,\r\n\r\n  // Saved sounds state\r\n  savedSounds: [],\r\n  isSavedSoundsLoaded: false,\r\n  isLoadingSavedSounds: false,\r\n  savedSoundsError: null,\r\n\r\n  setTopSoundEffects: (sounds) => set({ topSoundEffects: sounds }),\r\n  setLoading: (loading) => set({ isLoading: loading }),\r\n  setError: (error) => set({ error }),\r\n  setHasLoaded: (loaded) => set({ hasLoaded: loaded }),\r\n\r\n  // Search actions\r\n  setSearchQuery: (query) => set({ searchQuery: query }),\r\n  setSearchResults: (results) =>\r\n    set({ searchResults: results, currentPage: 1 }),\r\n  setSearching: (searching) => set({ isSearching: searching }),\r\n  setSearchError: (error) => set({ searchError: error }),\r\n  setLastSearchQuery: (query) => set({ lastSearchQuery: query }),\r\n  setScrollPosition: (position) => set({ scrollPosition: position }),\r\n\r\n  // Pagination actions\r\n  setCurrentPage: (page) => set({ currentPage: page }),\r\n  setHasNextPage: (hasNext) => set({ hasNextPage: hasNext }),\r\n  setTotalCount: (count) => set({ totalCount: count }),\r\n  setLoadingMore: (loading) => set({ isLoadingMore: loading }),\r\n  appendSearchResults: (results) =>\r\n    set((state) => ({\r\n      searchResults: [...state.searchResults, ...results],\r\n    })),\r\n  appendTopSounds: (results) =>\r\n    set((state) => ({\r\n      topSoundEffects: [...state.topSoundEffects, ...results],\r\n    })),\r\n  resetPagination: () =>\r\n    set({\r\n      currentPage: 1,\r\n      hasNextPage: false,\r\n      totalCount: 0,\r\n      isLoadingMore: false,\r\n    }),\r\n\r\n  // Saved sounds actions\r\n  loadSavedSounds: async () => {\r\n    if (get().isSavedSoundsLoaded) return;\r\n\r\n    try {\r\n      set({ isLoadingSavedSounds: true, savedSoundsError: null });\r\n      const savedSoundsData = await storageService.loadSavedSounds();\r\n      set({\r\n        savedSounds: savedSoundsData.sounds,\r\n        isSavedSoundsLoaded: true,\r\n        isLoadingSavedSounds: false,\r\n      });\r\n    } catch (error) {\r\n      const errorMessage =\r\n        error instanceof Error ? error.message : \"Failed to load saved sounds\";\r\n      set({\r\n        savedSoundsError: errorMessage,\r\n        isLoadingSavedSounds: false,\r\n      });\r\n      console.error(\"Failed to load saved sounds:\", error);\r\n    }\r\n  },\r\n\r\n  saveSoundEffect: async (soundEffect: SoundEffect) => {\r\n    try {\r\n      await storageService.saveSoundEffect({ soundEffect });\r\n\r\n      // Refresh saved sounds\r\n      const savedSoundsData = await storageService.loadSavedSounds();\r\n      set({ savedSounds: savedSoundsData.sounds });\r\n    } catch (error) {\r\n      const errorMessage =\r\n        error instanceof Error ? error.message : \"Failed to save sound\";\r\n      set({ savedSoundsError: errorMessage });\r\n      toast.error(\"Failed to save sound\");\r\n      console.error(\"Failed to save sound:\", error);\r\n    }\r\n  },\r\n\r\n  removeSavedSound: async (soundId: number) => {\r\n    try {\r\n      await storageService.removeSavedSound({ soundId });\r\n\r\n      // Update local state immediately\r\n      set((state) => ({\r\n        savedSounds: state.savedSounds.filter((sound) => sound.id !== soundId),\r\n      }));\r\n    } catch (error) {\r\n      const errorMessage =\r\n        error instanceof Error ? error.message : \"Failed to remove sound\";\r\n      set({ savedSoundsError: errorMessage });\r\n      toast.error(\"Failed to remove sound\");\r\n      console.error(\"Failed to remove sound:\", error);\r\n    }\r\n  },\r\n\r\n  isSoundSaved: (soundId: number) => {\r\n    const { savedSounds } = get();\r\n    return savedSounds.some((sound) => sound.id === soundId);\r\n  },\r\n\r\n  toggleSavedSound: async (soundEffect: SoundEffect) => {\r\n    const { isSoundSaved, saveSoundEffect, removeSavedSound } = get();\r\n\r\n    if (isSoundSaved(soundEffect.id)) {\r\n      await removeSavedSound(soundEffect.id);\r\n    } else {\r\n      await saveSoundEffect(soundEffect);\r\n    }\r\n  },\r\n\r\n  clearSavedSounds: async () => {\r\n    try {\r\n      await storageService.clearSavedSounds();\r\n      set({\r\n        savedSounds: [],\r\n        savedSoundsError: null,\r\n      });\r\n    } catch (error) {\r\n      const errorMessage =\r\n        error instanceof Error ? error.message : \"Failed to clear saved sounds\";\r\n      set({ savedSoundsError: errorMessage });\r\n      toast.error(\"Failed to clear saved sounds\");\r\n      console.error(\"Failed to clear saved sounds:\", error);\r\n    }\r\n  },\r\n\r\n  addSoundToTimeline: async (sound) => {\r\n    const activeProject = useProjectStore.getState().activeProject;\r\n    if (!activeProject) {\r\n      toast.error(\"No active project\");\r\n      return false;\r\n    }\r\n\r\n    const audioUrl = sound.previewUrl;\r\n    if (!audioUrl) {\r\n      toast.error(\"Sound file not available\");\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(audioUrl);\r\n      if (!response.ok)\r\n        throw new Error(`Failed to download audio: ${response.statusText}`);\r\n\r\n      const blob = await response.blob();\r\n      const file = new File([blob], `${sound.name}.mp3`, {\r\n        type: \"audio/mpeg\",\r\n      });\r\n\r\n      await useMediaStore.getState().addMediaFile(activeProject.id, {\r\n        name: sound.name,\r\n        type: \"audio\",\r\n        file,\r\n        duration: sound.duration,\r\n        url: URL.createObjectURL(file),\r\n      });\r\n\r\n      const mediaItem = useMediaStore\r\n        .getState()\r\n        .mediaFiles.find((item) => item.file === file);\r\n      if (!mediaItem) throw new Error(\"Failed to create media item\");\r\n\r\n      const success = useTimelineStore\r\n        .getState()\r\n        .addElementAtTime(mediaItem, usePlaybackStore.getState().currentTime);\r\n\r\n      if (success) {\r\n        return true;\r\n      }\r\n      throw new Error(\"Failed to add to timeline - check for overlaps\");\r\n    } catch (error) {\r\n      console.error(\"Failed to add sound to timeline:\", error);\r\n      toast.error(\r\n        error instanceof Error\r\n          ? error.message\r\n          : \"Failed to add sound to timeline\",\r\n        { id: `sound-${sound.id}` }\r\n      );\r\n      return false;\r\n    }\r\n  },\r\n}));\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1803, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/stores/stickers-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport {\n  getCollections,\n  getCollection,\n  searchIcons,\n  downloadSvgAsText,\n  svgToFile,\n  type IconSet,\n  type CollectionInfo,\n  type IconSearchResult,\n} from \"@/lib/iconify-api\";\nimport { useProjectStore } from \"@/stores/project-store\";\nimport { useMediaStore } from \"@/stores/media-store\";\nimport { useTimelineStore } from \"@/stores/timeline-store\";\nimport { usePlaybackStore } from \"@/stores/playback-store\";\nimport { TIMELINE_CONSTANTS } from \"@/constants/timeline-constants\";\nimport type { MediaFile } from \"@/types/media\";\n\nexport type StickerCategory = \"all\" | \"general\" | \"brands\" | \"emoji\";\n\ninterface StickersStore {\n  searchQuery: string;\n  selectedCategory: StickerCategory;\n  selectedCollection: string | null;\n  viewMode: \"search\" | \"browse\" | \"collection\";\n\n  collections: Record<string, IconSet>;\n  currentCollection: CollectionInfo | null;\n  searchResults: IconSearchResult | null;\n  recentStickers: string[];\n  isLoadingCollections: boolean;\n  isLoadingCollection: boolean;\n  isSearching: boolean;\n  isDownloading: boolean;\n  addingSticker: string | null;\n\n  setSearchQuery: (query: string) => void;\n  setSelectedCategory: (category: StickerCategory) => void;\n  setSelectedCollection: (collection: string | null) => void;\n  setViewMode: (mode: \"search\" | \"browse\" | \"collection\") => void;\n\n  loadCollections: () => Promise<void>;\n  loadCollection: (prefix: string) => Promise<void>;\n  searchStickers: (query: string) => Promise<void>;\n  downloadSticker: (iconName: string) => Promise<File | null>;\n  addStickerToTimeline: (iconName: string) => Promise<void>;\n\n  addToRecentStickers: (iconName: string) => void;\n  clearRecentStickers: () => void;\n}\n\nconst MAX_RECENT_STICKERS = 50;\n\nexport const useStickersStore = create<StickersStore>((set, get) => ({\n  searchQuery: \"\",\n  selectedCategory: \"all\",\n  selectedCollection: null,\n  viewMode: \"browse\",\n\n  collections: {},\n  currentCollection: null,\n  searchResults: null,\n  recentStickers: [],\n\n  isLoadingCollections: false,\n  isLoadingCollection: false,\n  isSearching: false,\n  isDownloading: false,\n  addingSticker: null,\n\n  setSearchQuery: (query) => set({ searchQuery: query }),\n\n  setSelectedCategory: (category) =>\n    set({\n      selectedCategory: category,\n      viewMode: \"browse\",\n      selectedCollection: null,\n      currentCollection: null,\n    }),\n\n  setSelectedCollection: (collection) => {\n    set({\n      selectedCollection: collection,\n      viewMode: collection ? \"collection\" : \"browse\",\n      currentCollection: null,\n    });\n\n    if (collection) {\n      get().loadCollection(collection);\n    }\n  },\n\n  setViewMode: (mode) => set({ viewMode: mode }),\n\n  loadCollections: async () => {\n    set({ isLoadingCollections: true });\n    try {\n      const collections = await getCollections();\n      set({ collections });\n    } catch (error) {\n      console.error(\"Failed to load collections:\", error);\n    } finally {\n      set({ isLoadingCollections: false });\n    }\n  },\n\n  loadCollection: async (prefix: string) => {\n    set({ isLoadingCollection: true });\n    try {\n      const collection = await getCollection(prefix);\n      set({ currentCollection: collection });\n    } catch (error) {\n      console.error(`Failed to load collection ${prefix}:`, error);\n      set({ currentCollection: null });\n    } finally {\n      set({ isLoadingCollection: false });\n    }\n  },\n\n  searchStickers: async (query: string) => {\n    if (!query.trim()) {\n      set({ searchResults: null, viewMode: \"browse\" });\n      return;\n    }\n\n    const { selectedCategory } = get();\n\n    set({ isSearching: true, viewMode: \"search\" });\n    try {\n      let category: string | undefined;\n\n      if (selectedCategory !== \"all\") {\n        if (selectedCategory === \"general\") {\n          category = \"General\";\n        } else if (selectedCategory === \"brands\") {\n          category = \"Brands / Social\";\n        } else if (selectedCategory === \"emoji\") {\n          category = \"Emoji\";\n        }\n      }\n\n      const results = await searchIcons(query, 100, undefined, category);\n      set({ searchResults: results });\n    } catch (error) {\n      console.error(\"Search failed:\", error);\n      set({ searchResults: null });\n    } finally {\n      set({ isSearching: false });\n    }\n  },\n\n  downloadSticker: async (iconName: string) => {\n    set({ isDownloading: true });\n    try {\n      const svgText = await downloadSvgAsText(iconName, {\n        width: 200,\n        height: 200,\n      });\n\n      const fileName = `${iconName.replace(\":\", \"-\")}.svg`;\n      const file = svgToFile(svgText, fileName);\n\n      get().addToRecentStickers(iconName);\n\n      return file;\n    } catch (error) {\n      console.error(`Failed to download sticker ${iconName}:`, error);\n      return null;\n    } finally {\n      set({ isDownloading: false });\n    }\n  },\n\n  addStickerToTimeline: async (iconName: string) => {\n    set({ addingSticker: iconName });\n    try {\n      const { activeProject } = useProjectStore.getState();\n      if (!activeProject) {\n        throw new Error(\"No active project\");\n      }\n\n      const file = await get().downloadSticker(iconName);\n      if (!file) {\n        throw new Error(\"Failed to download sticker\");\n      }\n\n      const mediaItem: Omit<MediaFile, \"id\"> = {\n        name: iconName.replace(\":\", \"-\"),\n        type: \"image\",\n        file,\n        url: URL.createObjectURL(file),\n        width: 200,\n        height: 200,\n        duration: TIMELINE_CONSTANTS.DEFAULT_IMAGE_DURATION,\n        ephemeral: false,\n      };\n\n      const { addMediaFile } = useMediaStore.getState();\n      await addMediaFile(activeProject.id, mediaItem);\n\n      const added = useMediaStore\n        .getState()\n        .mediaFiles.find(\n          (m) => m.url === mediaItem.url && m.name === mediaItem.name\n        );\n      if (!added) {\n        throw new Error(\"Sticker not in media store\");\n      }\n\n      const { currentTime } = usePlaybackStore.getState();\n      const { addElementAtTime } = useTimelineStore.getState();\n      addElementAtTime(added, currentTime);\n    } finally {\n      set({ addingSticker: null });\n    }\n  },\n\n  addToRecentStickers: (iconName: string) => {\n    set((state) => {\n      const recent = [\n        iconName,\n        ...state.recentStickers.filter((s) => s !== iconName),\n      ];\n      return {\n        recentStickers: recent.slice(0, MAX_RECENT_STICKERS),\n      };\n    });\n  },\n\n  clearRecentStickers: () => set({ recentStickers: [] }),\n}));\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2017, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/stores/editor-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport { CanvasPreset } from \"@/types/editor\";\n\nexport type PlatformLayout = \"tiktok\";\n\nexport const PLATFORM_LAYOUTS: Record<PlatformLayout, string> = {\n  tiktok: \"TikTok\",\n};\n\ninterface LayoutGuideSettings {\n  platform: PlatformLayout | null;\n}\n\ninterface EditorState {\n  // Loading states\n  isInitializing: boolean;\n  isPanelsReady: boolean;\n\n  // Editor UI settings\n  canvasPresets: CanvasPreset[];\n  layoutGuide: LayoutGuideSettings;\n\n  // Actions\n  setInitializing: (loading: boolean) => void;\n  setPanelsReady: (ready: boolean) => void;\n  initializeApp: () => Promise<void>;\n  setLayoutGuide: (settings: Partial<LayoutGuideSettings>) => void;\n  toggleLayoutGuide: (platform: PlatformLayout) => void;\n}\n\nconst DEFAULT_CANVAS_PRESETS: CanvasPreset[] = [\n  { name: \"16:9\", width: 1920, height: 1080 },\n  { name: \"9:16\", width: 1080, height: 1920 },\n  { name: \"1:1\", width: 1080, height: 1080 },\n  { name: \"4:3\", width: 1440, height: 1080 },\n];\n\nexport const useEditorStore = create<EditorState>()(\n  persist(\n    (set) => ({\n      // Initial states\n      isInitializing: true,\n      isPanelsReady: false,\n      canvasPresets: DEFAULT_CANVAS_PRESETS,\n      layoutGuide: {\n        platform: null,\n      },\n\n      // Actions\n      setInitializing: (loading) => {\n        set({ isInitializing: loading });\n      },\n\n      setPanelsReady: (ready) => {\n        set({ isPanelsReady: ready });\n      },\n\n      initializeApp: async () => {\n        console.log(\"Initializing video editor...\");\n        set({ isInitializing: true, isPanelsReady: false });\n\n        set({ isPanelsReady: true, isInitializing: false });\n        console.log(\"Video editor ready\");\n      },\n\n      setLayoutGuide: (settings) => {\n        set((state) => ({\n          layoutGuide: {\n            ...state.layoutGuide,\n            ...settings,\n          },\n        }));\n      },\n\n      toggleLayoutGuide: (platform) => {\n        set((state) => ({\n          layoutGuide: {\n            platform: state.layoutGuide.platform === platform ? null : platform,\n          },\n        }));\n      },\n    }),\n    {\n      name: \"editor-settings\",\n      partialize: (state) => ({\n        layoutGuide: state.layoutGuide,\n      }),\n    }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAKO,MAAM,mBAAmD;IAC9D,QAAQ;AACV;AAuBA,MAAM,yBAAyC;IAC7C;QAAE,MAAM;QAAQ,OAAO;QAAM,QAAQ;IAAK;IAC1C;QAAE,MAAM;QAAQ,OAAO;QAAM,QAAQ;IAAK;IAC1C;QAAE,MAAM;QAAO,OAAO;QAAM,QAAQ;IAAK;IACzC;QAAE,MAAM;QAAO,OAAO;QAAM,QAAQ;IAAK;CAC1C;AAEM,MAAM,iBAAiB,CAAA,GAAA,kNAAA,CAAA,SAAM,AAAD,IACjC,CAAA,GAAA,uNAAA,CAAA,UAAO,AAAD,EACJ,CAAC,MAAQ,CAAC;QACR,iBAAiB;QACjB,gBAAgB;QAChB,eAAe;QACf,eAAe;QACf,aAAa;YACX,UAAU;QACZ;QAEA,UAAU;QACV,iBAAiB,CAAC;YAChB,IAAI;gBAAE,gBAAgB;YAAQ;QAChC;QAEA,gBAAgB,CAAC;YACf,IAAI;gBAAE,eAAe;YAAM;QAC7B;QAEA,eAAe;YACb,QAAQ,GAAG,CAAC;YACZ,IAAI;gBAAE,gBAAgB;gBAAM,eAAe;YAAM;YAEjD,IAAI;gBAAE,eAAe;gBAAM,gBAAgB;YAAM;YACjD,QAAQ,GAAG,CAAC;QACd;QAEA,gBAAgB,CAAC;YACf,IAAI,CAAC,QAAU,CAAC;oBACd,aAAa;wBACX,GAAG,MAAM,WAAW;wBACpB,GAAG,QAAQ;oBACb;gBACF,CAAC;QACH;QAEA,mBAAmB,CAAC;YAClB,IAAI,CAAC,QAAU,CAAC;oBACd,aAAa;wBACX,UAAU,MAAM,WAAW,CAAC,QAAQ,KAAK,WAAW,OAAO;oBAC7D;gBACF,CAAC;QACH;IACF,CAAC,GACD;IACE,MAAM;IACN,YAAY,CAAC,QAAU,CAAC;YACtB,aAAa,MAAM,WAAW;QAChC,CAAC;AACH","debugId":null}},
    {"offset": {"line": 2111, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/stores/text-properties-store.ts"],"sourcesContent":["import { create } from \"zustand\";\r\nimport { persist } from \"zustand/middleware\";\r\n\r\nexport type TextPropertiesTab = \"transform\" | \"style\";\r\n\r\nexport interface TextPropertiesTabMeta {\r\n  value: TextPropertiesTab;\r\n  label: string;\r\n}\r\n\r\nexport const TEXT_PROPERTIES_TABS: ReadonlyArray<TextPropertiesTabMeta> = [\r\n  { value: \"transform\", label: \"Transform\" },\r\n  { value: \"style\", label: \"Style\" },\r\n] as const;\r\n\r\nexport function isTextPropertiesTab(value: string): value is TextPropertiesTab {\r\n  return TEXT_PROPERTIES_TABS.some((t) => t.value === value);\r\n}\r\n\r\ninterface TextPropertiesState {\r\n  activeTab: TextPropertiesTab;\r\n  setActiveTab: (tab: TextPropertiesTab) => void;\r\n}\r\n\r\nexport const useTextPropertiesStore = create<TextPropertiesState>()(\r\n  persist(\r\n    (set) => ({\r\n      activeTab: \"transform\",\r\n      setActiveTab: (tab) => set({ activeTab: tab }),\r\n    }),\r\n    { name: \"text-properties\" }\r\n  )\r\n);\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;AASO,MAAM,uBAA6D;IACxE;QAAE,OAAO;QAAa,OAAO;IAAY;IACzC;QAAE,OAAO;QAAS,OAAO;IAAQ;CAClC;AAEM,SAAS,oBAAoB,KAAa;IAC/C,OAAO,qBAAqB,IAAI,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK;AACtD;AAOO,MAAM,yBAAyB,CAAA,GAAA,kNAAA,CAAA,SAAM,AAAD,IACzC,CAAA,GAAA,uNAAA,CAAA,UAAO,AAAD,EACJ,CAAC,MAAQ,CAAC;QACR,WAAW;QACX,cAAc,CAAC,MAAQ,IAAI;gBAAE,WAAW;YAAI;IAC9C,CAAC,GACD;IAAE,MAAM;AAAkB","debugId":null}},
    {"offset": {"line": 2150, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/stores/keybindings-store.ts"],"sourcesContent":["\"use client\";\n\nimport { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport { ActionWithOptionalArgs } from \"@/constants/actions\";\nimport { isAppleDevice, isDOMElement, isTypableElement } from \"@/lib/utils\";\nimport { KeybindingConfig, ShortcutKey } from \"@/types/keybinding\";\n\n// Default keybindings configuration\nexport const defaultKeybindings: KeybindingConfig = {\n  space: \"toggle-play\",\n  j: \"seek-backward\",\n  k: \"toggle-play\",\n  l: \"seek-forward\",\n  left: \"frame-step-backward\",\n  right: \"frame-step-forward\",\n  \"shift+left\": \"jump-backward\",\n  \"shift+right\": \"jump-forward\",\n  home: \"goto-start\",\n  enter: \"goto-start\",\n  end: \"goto-end\",\n  s: \"split-element\",\n  n: \"toggle-snapping\",\n  \"ctrl+a\": \"select-all\",\n  \"ctrl+d\": \"duplicate-selected\",\n  \"ctrl+c\": \"copy-selected\",\n  \"ctrl+v\": \"paste-selected\",\n  \"ctrl+z\": \"undo\",\n  \"ctrl+shift+z\": \"redo\",\n  \"ctrl+y\": \"redo\",\n  delete: \"delete-selected\",\n  backspace: \"delete-selected\",\n};\n\nexport interface KeybindingConflict {\n  key: ShortcutKey;\n  existingAction: ActionWithOptionalArgs;\n  newAction: ActionWithOptionalArgs;\n}\n\ninterface KeybindingsState {\n  keybindings: KeybindingConfig;\n  isCustomized: boolean;\n  keybindingsEnabled: boolean;\n  isRecording: boolean;\n\n  // Actions\n  updateKeybinding: (key: ShortcutKey, action: ActionWithOptionalArgs) => void;\n  removeKeybinding: (key: ShortcutKey) => void;\n  resetToDefaults: () => void;\n  importKeybindings: (config: KeybindingConfig) => void;\n  exportKeybindings: () => KeybindingConfig;\n  enableKeybindings: () => void;\n  disableKeybindings: () => void;\n  setIsRecording: (isRecording: boolean) => void;\n\n  // Validation\n  validateKeybinding: (\n    key: ShortcutKey,\n    action: ActionWithOptionalArgs\n  ) => KeybindingConflict | null;\n  getKeybindingsForAction: (action: ActionWithOptionalArgs) => ShortcutKey[];\n\n  // Utility\n  getKeybindingString: (ev: KeyboardEvent) => ShortcutKey | null;\n}\n\nexport const useKeybindingsStore = create<KeybindingsState>()(\n  persist(\n    (set, get) => ({\n      keybindings: { ...defaultKeybindings },\n      isCustomized: false,\n      keybindingsEnabled: true,\n      isRecording: false,\n\n      updateKeybinding: (key: ShortcutKey, action: ActionWithOptionalArgs) => {\n        set((state) => {\n          const newKeybindings = { ...state.keybindings };\n          newKeybindings[key] = action;\n\n          return {\n            keybindings: newKeybindings,\n            isCustomized: true,\n          };\n        });\n      },\n\n      removeKeybinding: (key: ShortcutKey) => {\n        set((state) => {\n          const newKeybindings = { ...state.keybindings };\n          delete newKeybindings[key];\n\n          return {\n            keybindings: newKeybindings,\n            isCustomized: true,\n          };\n        });\n      },\n\n      resetToDefaults: () => {\n        set({\n          keybindings: { ...defaultKeybindings },\n          isCustomized: false,\n        });\n      },\n\n      enableKeybindings: () => {\n        set({ keybindingsEnabled: true });\n      },\n\n      disableKeybindings: () => {\n        set({ keybindingsEnabled: false });\n      },\n\n      importKeybindings: (config: KeybindingConfig) => {\n        // Validate all keys and actions\n        for (const [key, action] of Object.entries(config)) {\n          // Validate the key format\n          if (typeof key !== \"string\" || key.length === 0) {\n            throw new Error(`Invalid key format: ${key}`);\n          }\n        }\n        set({\n          keybindings: { ...config },\n          isCustomized: true,\n        });\n      },\n\n      exportKeybindings: () => {\n        return get().keybindings;\n      },\n\n      validateKeybinding: (\n        key: ShortcutKey,\n        action: ActionWithOptionalArgs\n      ) => {\n        const { keybindings } = get();\n        const existingAction = keybindings[key];\n\n        if (existingAction && existingAction !== action) {\n          return {\n            key,\n            existingAction,\n            newAction: action,\n          };\n        }\n\n        return null;\n      },\n      setIsRecording: (isRecording: boolean) => {\n        set({ isRecording });\n      },\n\n      getKeybindingsForAction: (action: ActionWithOptionalArgs) => {\n        const { keybindings } = get();\n        return Object.keys(keybindings).filter(\n          (key) => keybindings[key as ShortcutKey] === action\n        ) as ShortcutKey[];\n      },\n\n      getKeybindingString: (ev: KeyboardEvent) => {\n        return generateKeybindingString(ev) as ShortcutKey | null;\n      },\n    }),\n    {\n      name: \"opencut-keybindings\",\n      version: 2,\n    }\n  )\n);\n\n// Utility functions\nfunction generateKeybindingString(ev: KeyboardEvent): ShortcutKey | null {\n  const target = ev.target;\n\n  // We may or may not have a modifier key\n  const modifierKey = getActiveModifier(ev);\n\n  // We will always have a non-modifier key\n  const key = getPressedKey(ev);\n  if (!key) return null;\n\n  // All key combos backed by modifiers are valid shortcuts (whether currently typing or not)\n  if (modifierKey) {\n    // If the modifier is shift and the target is an input, we ignore\n    if (\n      modifierKey === \"shift\" &&\n      isDOMElement(target) &&\n      isTypableElement(target)\n    ) {\n      return null;\n    }\n\n    return `${modifierKey}+${key}` as ShortcutKey;\n  }\n\n  // no modifier key here then we do not do anything while on input\n  if (isDOMElement(target) && isTypableElement(target)) return null;\n\n  // single key while not input\n  return `${key}` as ShortcutKey;\n}\n\nfunction getPressedKey(ev: KeyboardEvent): string | null {\n  // Sometimes the property code is not available on the KeyboardEvent object\n  const key = (ev.key ?? \"\").toLowerCase();\n  const code = ev.code ?? \"\";\n\n  if (code === \"Space\" || key === \" \" || key === \"spacebar\" || key === \"space\")\n    return \"space\";\n\n  // Check arrow keys\n  if (key.startsWith(\"arrow\")) {\n    return key.slice(5);\n  }\n\n  // Check for special keys\n  if (key === \"tab\") return \"tab\";\n  if (key === \"home\") return \"home\";\n  if (key === \"end\") return \"end\";\n  if (key === \"delete\") return \"delete\";\n  if (key === \"backspace\") return \"backspace\";\n\n  // Check letter keys\n  if (code.startsWith(\"Key\")) {\n    const letter = code.slice(3).toLowerCase();\n    if (letter.length === 1 && letter >= \"a\" && letter <= \"z\") {\n      return letter;\n    }\n  }\n\n  // Check number keys using physical position for AZERTY support\n  if (code.startsWith(\"Digit\")) {\n    const digit = code.slice(5);\n    if (digit.length === 1 && digit >= \"0\" && digit <= \"9\") {\n      return digit;\n    }\n  }\n\n  // Fallback for other layouts\n  const isDigit = key.length === 1 && key >= \"0\" && key <= \"9\";\n  if (isDigit) return key;\n\n  // Check if slash, period or enter\n  if (key === \"/\" || key === \".\" || key === \"enter\") return key;\n\n  // If no other cases match, this is not a valid key\n  return null;\n}\n\nfunction getActiveModifier(ev: KeyboardEvent): string | null {\n  const modifierKeys = {\n    ctrl: isAppleDevice() ? ev.metaKey : ev.ctrlKey,\n    alt: ev.altKey,\n    shift: ev.shiftKey,\n  };\n\n  // active modifier: ctrl | alt | ctrl+alt | ctrl+shift | ctrl+alt+shift | alt+shift\n  // modiferKeys object's keys are sorted to match the above order\n  const activeModifier = Object.keys(modifierKeys)\n    .filter((key) => modifierKeys[key as keyof typeof modifierKeys])\n    .join(\"+\");\n\n  return activeModifier === \"\" ? null : activeModifier;\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2360, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/data/colors/solid.ts"],"sourcesContent":["export const colors = [\n  \"#ffffff\",\n  \"#000000\",\n  \"#ffe2e2\",\n  \"#ffc9c9\",\n  \"#ffa2a2\",\n  \"#ff6467\",\n  \"#fb2c36\",\n  \"#e7000b\",\n  \"#c10007\",\n  \"#9f0712\",\n  \"#82181a\",\n  \"#460809\",\n  \"#fff7ed\",\n  \"#ffedd4\",\n  \"#ffd6a7\",\n  \"#ffb86a\",\n  \"#ff8904\",\n  \"#ff6900\",\n  \"#f54900\",\n  \"#ca3500\",\n  \"#9f2d00\",\n  \"#7e2a0c\",\n  \"#441306\",\n  \"#fffbeb\",\n  \"#fef3c6\",\n  \"#fee685\",\n  \"#ffd230\",\n  \"#ffb900\",\n  \"#fe9a00\",\n  \"#e17100\",\n  \"#bb4d00\",\n  \"#973c00\",\n  \"#7b3306\",\n  \"#461901\",\n  \"#fefce8\",\n  \"#fef9c2\",\n  \"#fff085\",\n  \"#ffdf20\",\n  \"#fdc700\",\n  \"#f0b100\",\n  \"#d08700\",\n  \"#a65f00\",\n  \"#894b00\",\n  \"#733e0a\",\n  \"#432004\",\n  \"#f7fee7\",\n  \"#ecfcca\",\n  \"#d8f999\",\n  \"#bbf451\",\n  \"#9ae600\",\n  \"#7ccf00\",\n  \"#5ea500\",\n  \"#497d00\",\n  \"#3c6300\",\n  \"#35530e\",\n  \"#192e03\",\n  \"#f0fdf4\",\n  \"#dcfce7\",\n  \"#b9f8cf\",\n  \"#7bf1a8\",\n  \"#05df72\",\n  \"#00c950\",\n  \"#00a63e\",\n  \"#008236\",\n  \"#016630\",\n  \"#0d542b\",\n  \"#032e15\",\n  \"#ecfdf5\",\n  \"#d0fae5\",\n  \"#a4f4cf\",\n  \"#5ee9b5\",\n  \"#00d492\",\n  \"#00bc7d\",\n  \"#009966\",\n  \"#007a55\",\n  \"#006045\",\n  \"#004f3b\",\n  \"#002c22\",\n  \"#f0fdfa\",\n  \"#cbfbf1\",\n  \"#96f7e4\",\n  \"#46ecd5\",\n  \"#00d5be\",\n  \"#00bba7\",\n  \"#009689\",\n  \"#00786f\",\n  \"#005f5a\",\n  \"#0b4f4a\",\n  \"#022f2e\",\n  \"#ecfeff\",\n  \"#cefafe\",\n  \"#a2f4fd\",\n  \"#53eafd\",\n  \"#00d3f2\",\n  \"#00b8db\",\n  \"#0092b8\",\n  \"#007595\",\n  \"#005f78\",\n  \"#104e64\",\n  \"#053345\",\n  \"#f0f9ff\",\n  \"#dff2fe\",\n  \"#b8e6fe\",\n  \"#74d4ff\",\n  \"#00bcff\",\n  \"#00a6f4\",\n  \"#0084d1\",\n  \"#0069a8\",\n  \"#00598a\",\n  \"#024a70\",\n  \"#052f4a\",\n  \"#eff6ff\",\n  \"#dbeafe\",\n  \"#bedbff\",\n  \"#8ec5ff\",\n  \"#51a2ff\",\n  \"#2b7fff\",\n  \"#155dfc\",\n  \"#1447e6\",\n  \"#193cb8\",\n  \"#1c398e\",\n  \"#162456\",\n  \"#eef2ff\",\n  \"#e0e7ff\",\n  \"#c6d2ff\",\n  \"#a3b3ff\",\n  \"#7c86ff\",\n  \"#615fff\",\n  \"#4f39f6\",\n  \"#432dd7\",\n  \"#372aac\",\n  \"#312c85\",\n  \"#1e1a4d\",\n  \"#f5f3ff\",\n  \"#ede9fe\",\n  \"#ddd6ff\",\n  \"#c4b4ff\",\n  \"#a684ff\",\n  \"#8e51ff\",\n  \"#7f22fe\",\n  \"#7008e7\",\n  \"#5d0ec0\",\n  \"#4d179a\",\n  \"#2f0d68\",\n  \"#faf5ff\",\n  \"#f3e8ff\",\n  \"#e9d4ff\",\n  \"#dab2ff\",\n  \"#c27aff\",\n  \"#ad46ff\",\n  \"#9810fa\",\n  \"#8200db\",\n  \"#6e11b0\",\n  \"#59168b\",\n  \"#3c0366\",\n  \"#fdf4ff\",\n  \"#fae8ff\",\n  \"#f6cfff\",\n  \"#f4a8ff\",\n  \"#ed6aff\",\n  \"#e12afb\",\n  \"#c800de\",\n  \"#a800b7\",\n  \"#8a0194\",\n  \"#721378\",\n  \"#4b004f\",\n  \"#fdf2f8\",\n  \"#fce7f3\",\n  \"#fccee8\",\n  \"#fda5d5\",\n  \"#fb64b6\",\n  \"#f6339a\",\n  \"#e60076\",\n  \"#c6005c\",\n  \"#a3004c\",\n  \"#861043\",\n  \"#510424\",\n  \"#fff1f2\",\n  \"#ffe4e6\",\n  \"#ffccd3\",\n  \"#ffa1ad\",\n  \"#ff637e\",\n  \"#ff2056\",\n  \"#ec003f\",\n  \"#c70036\",\n  \"#a50036\",\n  \"#8b0836\",\n  \"#4d0218\",\n  \"#f8fafc\",\n  \"#f1f5f9\",\n  \"#e2e8f0\",\n  \"#cad5e2\",\n  \"#90a1b9\",\n  \"#62748e\",\n  \"#45556c\",\n  \"#314158\",\n  \"#1d293d\",\n  \"#0f172b\",\n  \"#020618\",\n  \"#f9fafb\",\n  \"#f3f4f6\",\n  \"#e5e7eb\",\n  \"#d1d5dc\",\n  \"#99a1af\",\n  \"#6a7282\",\n  \"#4a5565\",\n  \"#364153\",\n  \"#1e2939\",\n  \"#101828\",\n  \"#030712\",\n  \"#fafafa\",\n  \"#f4f4f5\",\n  \"#e4e4e7\",\n  \"#d4d4d8\",\n  \"#9f9fa9\",\n  \"#71717b\",\n  \"#52525c\",\n  \"#3f3f46\",\n  \"#27272a\",\n  \"#18181b\",\n  \"#09090b\",\n  \"#f5f5f5\",\n  \"#e5e5e5\",\n  \"#d4d4d4\",\n  \"#a1a1a1\",\n  \"#737373\",\n  \"#525252\",\n  \"#404040\",\n  \"#262626\",\n  \"#171717\",\n  \"#0a0a0a\",\n  \"#fafaf9\",\n  \"#f5f5f4\",\n  \"#e7e5e4\",\n  \"#d6d3d1\",\n  \"#a6a09b\",\n  \"#79716b\",\n  \"#57534d\",\n  \"#44403b\",\n  \"#292524\",\n  \"#1c1917\",\n  \"#0c0a09\",\n];\n"],"names":[],"mappings":";;;AAAO,MAAM,SAAS;IACpB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD","debugId":null}},
    {"offset": {"line": 2616, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/data/colors/pattern-craft.ts"],"sourcesContent":["// These are the gradients from Pattern Craft (https://patterncraft.fun/)\n\nexport const patternCraftGradients = [\n  // Dreamy Sky Pink Glow\n  \"radial-gradient(circle at 30% 70%, rgba(173, 216, 230, 0.35), transparent 60%), radial-gradient(circle at 70% 30%, rgba(255, 182, 193, 0.4), transparent 60%)\",\n\n  // Soft Warm Pastel Texture\n  \"radial-gradient(circle at 20% 80%, rgba(255, 182, 153, 0.3) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(255, 244, 214, 0.5) 0%, transparent 50%), radial-gradient(circle at 40% 40%, rgba(255, 182, 153, 0.1) 0%, transparent 50%), #fff8f0\",\n\n  // Warm Soft Coral & Cream\n  \"radial-gradient(circle at 20% 80%, rgba(255, 160, 146, 0.25) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(255, 244, 228, 0.3) 0%, transparent 50%), radial-gradient(circle at 40% 40%, rgba(255, 160, 146, 0.15) 0%, transparent 50%), #fef9f7\",\n\n  // Soft Green Glow\n  \"radial-gradient(circle at center, #8FFFB0, transparent), white\",\n\n  // Purple Glow Right\n  \"radial-gradient(circle at top right, rgba(173, 109, 244, 0.5), transparent 70%)\",\n\n  // Teal Glow Right\n  \"radial-gradient(circle at top right, rgba(56, 193, 182, 0.5), transparent 70%)\",\n\n  // Warm Orange Glow Right\n  \"radial-gradient(circle at top right, rgba(255, 140, 60, 0.5), transparent 70%)\",\n\n  // Cool Blue Glow Right\n  \"radial-gradient(circle at top right, rgba(70, 130, 180, 0.5), transparent 70%)\",\n\n  // Purple Glow Left\n  \"radial-gradient(circle at top left, rgba(173, 109, 244, 0.5), transparent 70%)\",\n\n  // Pastel Wave\n  \"linear-gradient(120deg, #d5c5ff 0%, #a7f3d0 50%, #f0f0f0 100%)\",\n];\n"],"names":[],"mappings":"AAAA,yEAAyE;;;;AAElE,MAAM,wBAAwB;IACnC,uBAAuB;IACvB;IAEA,2BAA2B;IAC3B;IAEA,0BAA0B;IAC1B;IAEA,kBAAkB;IAClB;IAEA,oBAAoB;IACpB;IAEA,kBAAkB;IAClB;IAEA,yBAAyB;IACzB;IAEA,uBAAuB;IACvB;IAEA,mBAAmB;IACnB;IAEA,cAAc;IACd;CACD","debugId":null}},
    {"offset": {"line": 2651, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/data/colors/syntax-ui.tsx"],"sourcesContent":["// These are the gradients from Syntax UI (https://syntaxui.com/effects/gradients)\n\nexport const syntaxUIGradients = [\n  // Cyan to Blue gradients\n  \"linear-gradient(to right, #22d3ee, #0ea5e9, #0284c7)\",\n  \"linear-gradient(to right, #bfdbfe, #a5f3fc)\",\n  \"linear-gradient(to right, #22d3ee, #0ea5e9, #0284c7)\",\n\n  // Purple gradients\n  \"linear-gradient(to right, #e9d5ff, #d8b4fe, #c084fc)\",\n  \"linear-gradient(to right, #c4b5fd, #a78bfa, #8b5cf6)\",\n\n  // Blue gradients\n  \"linear-gradient(to right, #93c5fd, #60a5fa, #3b82f6)\",\n  \"linear-gradient(to right, #93c5fd, #60a5fa, #3b82f6)\",\n\n  // Green gradients\n  \"linear-gradient(to right, #6ee7b7, #34d399, #10b981)\",\n  \"linear-gradient(to right, #d1fae5, #a7f3d0, #6ee7b7)\",\n\n  // Red gradient\n  \"linear-gradient(to right, #fca5a5, #f87171, #ef4444)\",\n\n  // Yellow/Orange gradient\n  \"linear-gradient(to right, #fde68a, #fbbf24, #f59e0b)\",\n\n  // Pink gradient\n  \"linear-gradient(to right, #fbcfe8, #f9a8d4, #f472b6)\",\n\n  // Neon radial gradient\n  \"radial-gradient(circle at bottom left, #ff00ff, #00ffff)\",\n];\n"],"names":[],"mappings":"AAAA,kFAAkF;;;;AAE3E,MAAM,oBAAoB;IAC/B,yBAAyB;IACzB;IACA;IACA;IAEA,mBAAmB;IACnB;IACA;IAEA,iBAAiB;IACjB;IACA;IAEA,kBAAkB;IAClB;IACA;IAEA,eAAe;IACf;IAEA,yBAAyB;IACzB;IAEA,gBAAgB;IAChB;IAEA,uBAAuB;IACvB;CACD","debugId":null}},
    {"offset": {"line": 2687, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/constants/font-constants.ts"],"sourcesContent":["export interface FontOption {\n  value: string;\n  label: string;\n  category: \"system\" | \"google\" | \"custom\";\n  weights?: number[];\n  hasClassName?: boolean;\n}\n\nexport const FONT_OPTIONS: FontOption[] = [\n  // System fonts (always available)\n  { value: \"Arial\", label: \"Arial\", category: \"system\", hasClassName: false },\n  {\n    value: \"Helvetica\",\n    label: \"Helvetica\",\n    category: \"system\",\n    hasClassName: false,\n  },\n  {\n    value: \"Times New Roman\",\n    label: \"Times New Roman\",\n    category: \"system\",\n    hasClassName: false,\n  },\n  {\n    value: \"Georgia\",\n    label: \"Georgia\",\n    category: \"system\",\n    hasClassName: false,\n  },\n\n  // Google Fonts (loaded in layout.tsx)\n  {\n    value: \"Inter\",\n    label: \"Inter\",\n    category: \"google\",\n    weights: [400, 700],\n    hasClassName: true,\n  },\n  {\n    value: \"Roboto\",\n    label: \"Roboto\",\n    category: \"google\",\n    weights: [400, 700],\n    hasClassName: true,\n  },\n  {\n    value: \"Open Sans\",\n    label: \"Open Sans\",\n    category: \"google\",\n    hasClassName: true,\n  },\n  {\n    value: \"Playfair Display\",\n    label: \"Playfair Display\",\n    category: \"google\",\n    hasClassName: true,\n  },\n  {\n    value: \"Comic Neue\",\n    label: \"Comic Neue\",\n    category: \"google\",\n    hasClassName: false,\n  },\n] as const;\n\nexport const DEFAULT_FONT = \"Arial\";\n\n// Type-safe font family union\nexport type FontFamily = (typeof FONT_OPTIONS)[number][\"value\"];\n\n// Helper functions\nexport const getFontByValue = (value: string): FontOption | undefined =>\n  FONT_OPTIONS.find((font) => font.value === value);\n\nexport const getGoogleFonts = (): FontOption[] =>\n  FONT_OPTIONS.filter((font) => font.category === \"google\");\n\nexport const getSystemFonts = (): FontOption[] =>\n  FONT_OPTIONS.filter((font) => font.category === \"system\");\n"],"names":[],"mappings":";;;;;;;AAQO,MAAM,eAA6B;IACxC,kCAAkC;IAClC;QAAE,OAAO;QAAS,OAAO;QAAS,UAAU;QAAU,cAAc;IAAM;IAC1E;QACE,OAAO;QACP,OAAO;QACP,UAAU;QACV,cAAc;IAChB;IACA;QACE,OAAO;QACP,OAAO;QACP,UAAU;QACV,cAAc;IAChB;IACA;QACE,OAAO;QACP,OAAO;QACP,UAAU;QACV,cAAc;IAChB;IAEA,sCAAsC;IACtC;QACE,OAAO;QACP,OAAO;QACP,UAAU;QACV,SAAS;YAAC;YAAK;SAAI;QACnB,cAAc;IAChB;IACA;QACE,OAAO;QACP,OAAO;QACP,UAAU;QACV,SAAS;YAAC;YAAK;SAAI;QACnB,cAAc;IAChB;IACA;QACE,OAAO;QACP,OAAO;QACP,UAAU;QACV,cAAc;IAChB;IACA;QACE,OAAO;QACP,OAAO;QACP,UAAU;QACV,cAAc;IAChB;IACA;QACE,OAAO;QACP,OAAO;QACP,UAAU;QACV,cAAc;IAChB;CACD;AAEM,MAAM,eAAe;AAMrB,MAAM,iBAAiB,CAAC,QAC7B,aAAa,IAAI,CAAC,CAAC,OAAS,KAAK,KAAK,KAAK;AAEtC,MAAM,iBAAiB,IAC5B,aAAa,MAAM,CAAC,CAAC,OAAS,KAAK,QAAQ,KAAK;AAE3C,MAAM,iBAAiB,IAC5B,aAAa,MAAM,CAAC,CAAC,OAAS,KAAK,QAAQ,KAAK","debugId":null}},
    {"offset": {"line": 2773, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/constants/actions.ts"],"sourcesContent":["/* An `action` is a unique verb that is associated with certain thing that can be done on OpenCut.\n * For example, toggling playback or seeking.\n */\n\nimport {\n  useEffect,\n  useRef,\n  useState,\n  useCallback,\n  MutableRefObject,\n} from \"react\";\n\n// Simple event emitter for action changes\nclass ActionEmitter {\n  private listeners: Array<(actions: Action[]) => void> = [];\n\n  subscribe(listener: (actions: Action[]) => void) {\n    this.listeners.push(listener);\n    return () => {\n      this.listeners = this.listeners.filter((l) => l !== listener);\n    };\n  }\n\n  emit(actions: Action[]) {\n    this.listeners.forEach((listener) => listener(actions));\n  }\n}\n\nconst actionEmitter = new ActionEmitter();\n\nexport type Action =\n  | \"toggle-play\" // Toggle play/pause state\n  | \"stop-playback\" // Stop playback\n  | \"seek-forward\" // Seek forward in playback\n  | \"seek-backward\" // Seek backward in playback\n  | \"frame-step-forward\" // Step forward by one frame\n  | \"frame-step-backward\" // Step backward by one frame\n  | \"jump-forward\" // Jump forward by 5 seconds\n  | \"jump-backward\" // Jump backward by 5 seconds\n  | \"goto-start\" // Go to timeline start\n  | \"goto-end\" // Go to timeline end\n  | \"split-element\" // Split element at current time\n  | \"delete-selected\" // Delete selected elements\n  | \"select-all\" // Select all elements\n  | \"duplicate-selected\" // Duplicate selected element\n  | \"toggle-snapping\" // Toggle snapping\n  | \"undo\" // Undo last action\n  | \"redo\" // Redo last undone action\n  | \"copy-selected\" // Copy selected elements to clipboard\n  | \"paste-selected\"; // Paste elements from clipboard at playhead\n\n/**\n * Defines the arguments, if present for a given type that is required to be passed on\n * invocation and will be passed to action handlers.\n *\n * This type is supposed to be an object with the key being one of the actions mentioned above.\n * The value to the key can be anything.\n * If an action has no argument, you do not need to add it to this type.\n *\n * NOTE: We can't enforce type checks to make sure the key is Action, you\n * will know if you got something wrong if there is a type error in this file\n */\ntype ActionArgsMap = {\n  \"seek-forward\": { seconds: number } | undefined; // Args needed for seeking forward (default: 1)\n  \"seek-backward\": { seconds: number } | undefined; // Args needed for seeking backward (default: 1)\n  \"jump-forward\": { seconds: number } | undefined; // Args needed for jumping forward (default: 5)\n  \"jump-backward\": { seconds: number } | undefined; // Args needed for jumping backward (default: 5)\n};\n\ntype KeysWithValueUndefined<T> = {\n  [K in keyof T]: undefined extends T[K] ? K : never;\n}[keyof T];\n\n/**\n * Actions which require arguments for their invocation\n */\nexport type ActionWithArgs = keyof ActionArgsMap;\n\n/**\n * Actions which optionally takes in arguments for their invocation\n */\n\nexport type ActionWithOptionalArgs =\n  | ActionWithNoArgs\n  | KeysWithValueUndefined<ActionArgsMap>;\n\n/**\n * Actions which do not require arguments for their invocation\n */\nexport type ActionWithNoArgs = Exclude<Action, ActionWithArgs>;\n\n/**\n * Resolves the argument type for a given Action\n */\ntype ArgOfHoppAction<A extends Action> = A extends ActionWithArgs\n  ? ActionArgsMap[A]\n  : undefined;\n\n/**\n * Resolves the action function for a given Action, used by action handler function defs\n */\ntype ActionFunc<A extends Action> = A extends ActionWithArgs\n  ? (arg: ArgOfHoppAction<A>, trigger?: InvocationTriggers) => void\n  : (_?: undefined, trigger?: InvocationTriggers) => void;\n\ntype BoundActionList = {\n  [A in Action]?: Array<ActionFunc<A>>;\n};\n\nconst boundActions: BoundActionList = {};\n\nlet currentActiveActions: Action[] = [];\n\nfunction updateActiveActions() {\n  const newActions = Object.keys(boundActions) as Action[];\n  currentActiveActions = newActions;\n  actionEmitter.emit(newActions);\n}\n\nexport function bindAction<A extends Action>(\n  action: A,\n  handler: ActionFunc<A>\n) {\n  if (boundActions[action]) {\n    boundActions[action]?.push(handler);\n  } else {\n    // 'any' assertion because TypeScript doesn't seem to be able to figure out the links.\n    boundActions[action] = [handler] as any;\n  }\n\n  updateActiveActions();\n}\n\nexport type InvocationTriggers = \"keypress\" | \"mouseclick\";\n\ntype InvokeActionFunc = {\n  (\n    action: ActionWithOptionalArgs,\n    args?: undefined,\n    trigger?: InvocationTriggers\n  ): void;\n  <A extends ActionWithArgs>(action: A, args: ActionArgsMap[A]): void;\n};\n\n/**\n * Invokes an action, triggering action handlers if any registered.\n * The second and third arguments are optional\n * @param action The action to fire\n * @param args The argument passed to the action handler. Optional if action has no args required\n * @param trigger Optionally supply the trigger that invoked the action (keypress/mouseclick)\n */\nexport const invokeAction: InvokeActionFunc = <A extends Action>(\n  action: A,\n  args?: ArgOfHoppAction<A>,\n  trigger?: InvocationTriggers\n) => {\n  boundActions[action]?.forEach((handler) => (handler as any)(args, trigger));\n};\n\nexport function unbindAction<A extends Action>(\n  action: A,\n  handler: ActionFunc<A>\n) {\n  // 'any' assertion because TypeScript doesn't seem to be able to figure out the links.\n  boundActions[action] = boundActions[action]?.filter(\n    (x) => x !== handler\n  ) as any;\n\n  if (boundActions[action]?.length === 0) {\n    delete boundActions[action];\n  }\n\n  updateActiveActions();\n}\n\n/**\n * Returns whether a given action is bound at a given time\n *\n * @param action The action to check\n */\nexport function isActionBound(action: Action): boolean {\n  return !!boundActions[action];\n}\n\n/**\n * A React hook that defines a component can handle a given\n * Action. The handler will be bound when the component is mounted\n * and unbound when the component is unmounted.\n * @param action The action to be bound\n * @param handler The function to be called when the action is invoked\n * @param isActive A ref that indicates whether the action is active\n */\nexport function useActionHandler<A extends Action>(\n  action: A,\n  handler: ActionFunc<A>,\n  isActive: MutableRefObject<boolean> | boolean | undefined\n) {\n  const handlerRef = useRef(handler);\n  const [isBound, setIsBound] = useState(false);\n\n  // Update handler ref when handler changes\n  useEffect(() => {\n    handlerRef.current = handler;\n  }, [handler]);\n\n  // Create a stable handler wrapper\n  const stableHandler = useCallback(\n    (args: any, trigger?: InvocationTriggers) => {\n      (handlerRef.current as any)(args, trigger);\n    },\n    []\n  ) as ActionFunc<A>;\n\n  useEffect(() => {\n    const shouldBind =\n      isActive === undefined ||\n      (typeof isActive === \"boolean\" ? isActive : isActive.current);\n\n    if (shouldBind && !isBound) {\n      bindAction(action, stableHandler);\n      setIsBound(true);\n    } else if (!shouldBind && isBound) {\n      unbindAction(action, stableHandler);\n      setIsBound(false);\n    }\n\n    return () => {\n      if (isBound) {\n        unbindAction(action, stableHandler);\n        setIsBound(false);\n      }\n    };\n  }, [action, stableHandler, isActive, isBound]);\n\n  // Handle ref-based isActive changes\n  useEffect(() => {\n    if (isActive && typeof isActive === \"object\" && \"current\" in isActive) {\n      // Poll for ref changes\n      const interval = setInterval(() => {\n        const shouldBind = isActive.current;\n        if (shouldBind !== isBound) {\n          if (shouldBind) {\n            bindAction(action, stableHandler);\n          } else {\n            unbindAction(action, stableHandler);\n          }\n          setIsBound(shouldBind);\n        }\n      }, 100);\n      return () => clearInterval(interval);\n    }\n  }, [action, stableHandler, isActive, isBound]);\n}\n\n/**\n * A React hook that returns the current list of active actions\n * and re-renders when the list changes\n */\nexport function useActiveActions(): Action[] {\n  const [activeActions, setActiveActions] = useState<Action[]>([]);\n\n  useEffect(() => {\n    // Set initial value\n    setActiveActions(currentActiveActions);\n\n    // Subscribe to changes\n    const unsubscribe = actionEmitter.subscribe(setActiveActions);\n    return unsubscribe;\n  }, []);\n\n  return activeActions;\n}\n\n/**\n * A React hook that returns whether a specific action is currently bound\n * and re-renders when the binding state changes\n */\nexport function useIsActionBound(action: Action): boolean {\n  const [isBound, setIsBound] = useState(() => isActionBound(action));\n\n  useEffect(() => {\n    const updateBoundState = () => {\n      setIsBound(isActionBound(action));\n    };\n\n    // Set initial value\n    updateBoundState();\n\n    // Subscribe to changes\n    const unsubscribe = actionEmitter.subscribe(updateBoundState);\n    return unsubscribe;\n  }, [action]);\n\n  return isBound;\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2962, "column": 0}, "map": {"version":3,"sources":["file:///C:/shawn/1code/1project-cur/video-remake/clip/OpenCut-main/apps/web/src/app/editor/%5Bproject_id%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef } from \"react\";\nimport { useParams, useRouter } from \"next/navigation\";\nimport {\n  ResizablePanelGroup,\n  ResizablePanel,\n  ResizableHandle,\n} from \"@/components/ui/resizable\";\nimport { MediaPanel } from \"@/components/editor/media-panel\";\nimport { PropertiesPanel } from \"@/components/editor/properties-panel\";\nimport { Timeline } from \"@/components/editor/timeline\";\nimport { PreviewPanel } from \"@/components/editor/preview-panel\";\nimport { EditorHeader } from \"@/components/editor/editor-header\";\nimport { usePanelStore } from \"@/stores/panel-store\";\nimport { useProjectStore } from \"@/stores/project-store\";\nimport { EditorProvider } from \"@/components/providers/editor-provider\";\nimport { usePlaybackControls } from \"@/hooks/use-playback-controls\";\nimport { Onboarding } from \"@/components/editor/onboarding\";\n\nexport default function Editor() {\n  const {\n    toolsPanel,\n    previewPanel,\n    mainContent,\n    timeline,\n    setToolsPanel,\n    setPreviewPanel,\n    setMainContent,\n    setTimeline,\n    propertiesPanel,\n    setPropertiesPanel,\n    activePreset,\n    resetCounter,\n  } = usePanelStore();\n\n  const {\n    activeProject,\n    loadProject,\n    createNewProject,\n    isInvalidProjectId,\n    markProjectIdAsInvalid,\n  } = useProjectStore();\n  const params = useParams();\n  const router = useRouter();\n  const projectId = params.project_id as string;\n  const handledProjectIds = useRef<Set<string>>(new Set());\n  const isInitializingRef = useRef<boolean>(false);\n\n  usePlaybackControls();\n\n  useEffect(() => {\n    let isCancelled = false;\n\n    const initProject = async () => {\n      if (!projectId) {\n        return;\n      }\n\n      // Prevent duplicate initialization\n      if (isInitializingRef.current) {\n        return;\n      }\n\n      // Check if project is already loaded\n      if (activeProject?.id === projectId) {\n        return;\n      }\n\n      // Check global invalid tracking first (most important for preventing duplicates)\n      if (isInvalidProjectId(projectId)) {\n        return;\n      }\n\n      // Check if we've already handled this project ID locally\n      if (handledProjectIds.current.has(projectId)) {\n        return;\n      }\n\n      // Mark as initializing to prevent race conditions\n      isInitializingRef.current = true;\n      handledProjectIds.current.add(projectId);\n\n      try {\n        await loadProject(projectId);\n\n        // Check if component was unmounted during async operation\n        if (isCancelled) {\n          return;\n        }\n\n        // Project loaded successfully\n        isInitializingRef.current = false;\n      } catch (error) {\n        // Check if component was unmounted during async operation\n        if (isCancelled) {\n          return;\n        }\n\n        // More specific error handling - only create new project for actual \"not found\" errors\n        const isProjectNotFound =\n          error instanceof Error &&\n          (error.message.includes(\"not found\") ||\n            error.message.includes(\"does not exist\") ||\n            error.message.includes(\"Project not found\"));\n\n        if (isProjectNotFound) {\n          // Mark this project ID as invalid globally BEFORE creating project\n          markProjectIdAsInvalid(projectId);\n\n          try {\n            const newProjectId = await createNewProject(\"Untitled Project\");\n\n            // Check again if component was unmounted\n            if (isCancelled) {\n              return;\n            }\n\n            router.replace(`/editor/${newProjectId}`);\n          } catch (createError) {\n            console.error(\"Failed to create new project:\", createError);\n          }\n        } else {\n          // For other errors (storage issues, corruption, etc.), don't create new project\n          console.error(\n            \"Project loading failed with recoverable error:\",\n            error\n          );\n          // Remove from handled set so user can retry\n          handledProjectIds.current.delete(projectId);\n        }\n\n        isInitializingRef.current = false;\n      }\n    };\n\n    initProject();\n\n    // Cleanup function to cancel async operations\n    return () => {\n      isCancelled = true;\n      isInitializingRef.current = false;\n    };\n  }, [\n    projectId,\n    loadProject,\n    createNewProject,\n    router,\n    isInvalidProjectId,\n    markProjectIdAsInvalid,\n  ]);\n\n  return (\n    <EditorProvider>\n      <div className=\"h-screen w-screen flex flex-col bg-background overflow-hidden\">\n        <EditorHeader />\n        <div className=\"flex-1 min-h-0 min-w-0\">\n          {activePreset === \"media\" ? (\n            <ResizablePanelGroup\n              key={`media-${activePreset}-${resetCounter}`}\n              direction=\"horizontal\"\n              className=\"h-full w-full gap-[0.18rem] px-3 pb-3\"\n            >\n              <ResizablePanel\n                defaultSize={toolsPanel}\n                minSize={15}\n                maxSize={40}\n                onResize={setToolsPanel}\n                className=\"min-w-0 rounded-sm\"\n              >\n                <MediaPanel />\n              </ResizablePanel>\n\n              <ResizableHandle withHandle />\n\n              <ResizablePanel\n                defaultSize={100 - toolsPanel}\n                minSize={60}\n                className=\"min-w-0 min-h-0\"\n              >\n                <ResizablePanelGroup\n                  direction=\"vertical\"\n                  className=\"h-full w-full gap-[0.18rem]\"\n                >\n                  <ResizablePanel\n                    defaultSize={mainContent}\n                    minSize={30}\n                    maxSize={85}\n                    onResize={setMainContent}\n                    className=\"min-h-0\"\n                  >\n                    <ResizablePanelGroup\n                      direction=\"horizontal\"\n                      className=\"h-full w-full gap-[0.19rem]\"\n                    >\n                      <ResizablePanel\n                        defaultSize={previewPanel}\n                        minSize={30}\n                        onResize={setPreviewPanel}\n                        className=\"min-w-0 min-h-0 flex-1\"\n                      >\n                        <PreviewPanel />\n                      </ResizablePanel>\n\n                      <ResizableHandle withHandle />\n\n                      <ResizablePanel\n                        defaultSize={propertiesPanel}\n                        minSize={15}\n                        maxSize={40}\n                        onResize={setPropertiesPanel}\n                        className=\"min-w-0\"\n                      >\n                        <PropertiesPanel />\n                      </ResizablePanel>\n                    </ResizablePanelGroup>\n                  </ResizablePanel>\n\n                  <ResizableHandle withHandle />\n\n                  <ResizablePanel\n                    defaultSize={timeline}\n                    minSize={15}\n                    maxSize={70}\n                    onResize={setTimeline}\n                    className=\"min-h-0\"\n                  >\n                    <Timeline />\n                  </ResizablePanel>\n                </ResizablePanelGroup>\n              </ResizablePanel>\n            </ResizablePanelGroup>\n          ) : activePreset === \"inspector\" ? (\n            <ResizablePanelGroup\n              key={`inspector-${activePreset}-${resetCounter}`}\n              direction=\"horizontal\"\n              className=\"h-full w-full gap-[0.18rem] px-3 pb-3\"\n            >\n              <ResizablePanel\n                defaultSize={100 - propertiesPanel}\n                minSize={30}\n                onResize={(size) => setPropertiesPanel(100 - size)}\n                className=\"min-w-0 min-h-0\"\n              >\n                <ResizablePanelGroup\n                  direction=\"vertical\"\n                  className=\"h-full w-full gap-[0.18rem]\"\n                >\n                  <ResizablePanel\n                    defaultSize={mainContent}\n                    minSize={30}\n                    maxSize={85}\n                    onResize={setMainContent}\n                    className=\"min-h-0\"\n                  >\n                    <ResizablePanelGroup\n                      direction=\"horizontal\"\n                      className=\"h-full w-full gap-[0.19rem]\"\n                    >\n                      <ResizablePanel\n                        defaultSize={toolsPanel}\n                        minSize={15}\n                        maxSize={40}\n                        onResize={setToolsPanel}\n                        className=\"min-w-0 rounded-sm\"\n                      >\n                        <MediaPanel />\n                      </ResizablePanel>\n\n                      <ResizableHandle withHandle />\n\n                      <ResizablePanel\n                        defaultSize={previewPanel}\n                        minSize={30}\n                        onResize={setPreviewPanel}\n                        className=\"min-w-0 min-h-0 flex-1\"\n                      >\n                        <PreviewPanel />\n                      </ResizablePanel>\n                    </ResizablePanelGroup>\n                  </ResizablePanel>\n\n                  <ResizableHandle withHandle />\n\n                  <ResizablePanel\n                    defaultSize={timeline}\n                    minSize={15}\n                    maxSize={70}\n                    onResize={setTimeline}\n                    className=\"min-h-0\"\n                  >\n                    <Timeline />\n                  </ResizablePanel>\n                </ResizablePanelGroup>\n              </ResizablePanel>\n\n              <ResizableHandle withHandle />\n\n              <ResizablePanel\n                defaultSize={propertiesPanel}\n                minSize={15}\n                maxSize={40}\n                onResize={setPropertiesPanel}\n                className=\"min-w-0 min-h-0\"\n              >\n                <PropertiesPanel />\n              </ResizablePanel>\n            </ResizablePanelGroup>\n          ) : activePreset === \"vertical-preview\" ? (\n            <ResizablePanelGroup\n              key={`vertical-preview-${activePreset}-${resetCounter}`}\n              direction=\"horizontal\"\n              className=\"h-full w-full gap-[0.18rem] px-3 pb-3\"\n            >\n              <ResizablePanel\n                defaultSize={100 - previewPanel}\n                minSize={30}\n                onResize={(size) => setPreviewPanel(100 - size)}\n                className=\"min-w-0 min-h-0\"\n              >\n                <ResizablePanelGroup\n                  direction=\"vertical\"\n                  className=\"h-full w-full gap-[0.18rem]\"\n                >\n                  <ResizablePanel\n                    defaultSize={mainContent}\n                    minSize={30}\n                    maxSize={85}\n                    onResize={setMainContent}\n                    className=\"min-h-0\"\n                  >\n                    <ResizablePanelGroup\n                      direction=\"horizontal\"\n                      className=\"h-full w-full gap-[0.19rem]\"\n                    >\n                      <ResizablePanel\n                        defaultSize={toolsPanel}\n                        minSize={15}\n                        maxSize={40}\n                        onResize={setToolsPanel}\n                        className=\"min-w-0 rounded-sm\"\n                      >\n                        <MediaPanel />\n                      </ResizablePanel>\n\n                      <ResizableHandle withHandle />\n\n                      <ResizablePanel\n                        defaultSize={propertiesPanel}\n                        minSize={15}\n                        maxSize={40}\n                        onResize={setPropertiesPanel}\n                        className=\"min-w-0\"\n                      >\n                        <PropertiesPanel />\n                      </ResizablePanel>\n                    </ResizablePanelGroup>\n                  </ResizablePanel>\n\n                  <ResizableHandle withHandle />\n\n                  <ResizablePanel\n                    defaultSize={timeline}\n                    minSize={15}\n                    maxSize={70}\n                    onResize={setTimeline}\n                    className=\"min-h-0\"\n                  >\n                    <Timeline />\n                  </ResizablePanel>\n                </ResizablePanelGroup>\n              </ResizablePanel>\n\n              <ResizableHandle withHandle />\n\n              <ResizablePanel\n                defaultSize={previewPanel}\n                minSize={30}\n                onResize={setPreviewPanel}\n                className=\"min-w-0 min-h-0\"\n              >\n                <PreviewPanel />\n              </ResizablePanel>\n            </ResizablePanelGroup>\n          ) : (\n            <ResizablePanelGroup\n              key={`default-${activePreset}-${resetCounter}`}\n              direction=\"vertical\"\n              className=\"h-full w-full gap-[0.18rem]\"\n            >\n              <ResizablePanel\n                defaultSize={mainContent}\n                minSize={30}\n                maxSize={85}\n                onResize={setMainContent}\n                className=\"min-h-0\"\n              >\n                {/* Main content area */}\n                <ResizablePanelGroup\n                  direction=\"horizontal\"\n                  className=\"h-full w-full gap-[0.19rem] px-3\"\n                >\n                  {/* Tools Panel */}\n                  <ResizablePanel\n                    defaultSize={toolsPanel}\n                    minSize={15}\n                    maxSize={40}\n                    onResize={setToolsPanel}\n                    className=\"min-w-0 rounded-sm\"\n                  >\n                    <MediaPanel />\n                  </ResizablePanel>\n\n                  <ResizableHandle withHandle />\n\n                  {/* Preview Area */}\n                  <ResizablePanel\n                    defaultSize={previewPanel}\n                    minSize={30}\n                    onResize={setPreviewPanel}\n                    className=\"min-w-0 min-h-0 flex-1\"\n                  >\n                    <PreviewPanel />\n                  </ResizablePanel>\n\n                  <ResizableHandle withHandle />\n\n                  <ResizablePanel\n                    defaultSize={propertiesPanel}\n                    minSize={15}\n                    maxSize={40}\n                    onResize={setPropertiesPanel}\n                    className=\"min-w-0 rounded-sm\"\n                  >\n                    <PropertiesPanel />\n                  </ResizablePanel>\n                </ResizablePanelGroup>\n              </ResizablePanel>\n\n              <ResizableHandle withHandle />\n\n              {/* Timeline */}\n              <ResizablePanel\n                defaultSize={timeline}\n                minSize={15}\n                maxSize={70}\n                onResize={setTimeline}\n                className=\"min-h-0 px-3 pb-3\"\n              >\n                <Timeline />\n              </ResizablePanel>\n            </ResizablePanelGroup>\n          )}\n        </div>\n        <Onboarding />\n      </div>\n    </EditorProvider>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}